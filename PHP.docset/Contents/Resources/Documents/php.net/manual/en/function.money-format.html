<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>数値を金額文字列にフォーマットする</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.metaphone.html">metaphone</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.nl-langinfo.html">nl_langinfo</a></div>
 <div class="up"><a href="ref.strings.html">String 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.money-format" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">money_format</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.3.0, PHP 5, PHP 7)</p><p class="refpurpose"><span class="refname">money_format</span> &mdash; <span class="dc-title">数値を金額文字列にフォーマットする</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-function.money-format-description">
  <h3 class="title">説明</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">string</span> <span class="methodname"><strong>money_format</strong></span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$format</code></span>
   , <span class="methodparam"><span class="type">float</span> <code class="parameter">$number</code></span>
   )</div>

  <p class="para rdfs-comment">
   <span class="function"><strong>money_format()</strong></span> は、<code class="parameter">number</code>
   をフォーマットして返します。この関数は C のライブラリ関数
   <span class="function"><strong>strfmon()</strong></span> をラップしたものですが、一度に
   変換できる数値がひとつだけであるという点が異なります。
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.money-format-parameters">
  <h3 class="title">パラメータ</h3>
  <p class="para">
   <dl>

    
     <dt>
<code class="parameter">format</code></dt>

     <dd>

      <p class="para">
       フォーマット指定の書式は以下の順になります。
       <ul class="itemizedlist">
        <li class="listitem"><p class="para"><em>%</em> 文字</p></li>
        <li class="listitem"><p class="para">フラグ(オプション)</p></li>
        <li class="listitem"><p class="para">フィールドの幅(オプション)</p></li>
        <li class="listitem"><p class="para">左精度(オプション)</p></li>
        <li class="listitem"><p class="para">右精度(オプション)</p></li>
        <li class="listitem"><p class="para">変換文字(必須)</p></li>
       </ul>
      </p>
      <p class="formalpara">
       <h5 class="title">フラグ</h5>
       <p class="para">
       以下のフラグのうちひとつあるいは複数が使用可能です。
        <dl>

         
          <dt>
<em>=</em><span class="replaceable">f</span></dt>

          <dd>

           <p class="para">
            文字 <em>=</em> の後に続く(シングルバイトの)文字
            <span class="replaceable">f</span> が、数値埋め文字として使用されます。
            デフォルトはスペース文字です。
           </p>
          </dd>

         
         
          <dt>
<em>^</em></dt>

          <dd>

           <p class="para">
            グループ化文字(現在のロケールで定義されている)を使用しないようにします。
           </p>
          </dd>

         
         
          <dt>
<em>+</em> あるいは <em>(</em></dt>

          <dd>

           <p class="para">
            正の数、負の数の書式を指定します。<em>+</em> が使用された場合、
            <em>+</em> および <em>-</em> に該当する
            そのロケールの符号マークが使用されます。<em>(</em>
            が使用された場合、負の数は括弧で囲まれます。何も指定しなかった場合、
            デフォルトは <em>+</em> です。
           </p>
          </dd>

         
         
          <dt>
<em>!</em></dt>

          <dd>

           <p class="para">
            出力文字列から通貨記号を除きます。
           </p>
          </dd>

         
         
          <dt>
<em>-</em></dt>

          <dd>

           <p class="para">
            指定した場合、すべてのフィールドを左詰め(右側に数値埋め文字が追加される)
            にします。デフォルトはこれと反対で、すべてのフィールドを右詰め
            (左側に数値埋め文字が追加される)にします。
           </p>
          </dd>

         
        </dl>

       </p>
      </p>
      <p class="formalpara">
       <h5 class="title">フィールドの幅</h5>
       <p class="para">
        <dl>

         
          <dt>
<span class="replaceable">w</span></dt>

          <dd>

           <p class="para">
            10 進の数値形式の文字列で、フィールドの幅の最小値を指定します。フラグ
            <em>-</em> が使用されていない限り、フィールドは
            右詰めとなります。デフォルト値は 0(ゼロ) です。
           </p>
          </dd>

         
        </dl>

       </p>
      </p>
      <p class="formalpara">
       <h5 class="title">左精度</h5>
       <p class="para">
        <dl>

         
          <dt>
<em>#</em><span class="replaceable">n</span></dt>

          <dd>

           <p class="para">
            10 進の基準文字(例: 小数点)より左側の最大の桁数
            (<span class="replaceable">n</span>) を指定します。これは通常、
            <span class="replaceable">n</span> より少ない桁数の数値に対して
            数値埋め文字を使用することで、出力の桁位置をそろえるために
            使用されます。実際の桁数が <span class="replaceable">n</span> より
            大きい場合、この設定は無視されます。
           </p>
           <p class="para">
            <em>^</em> フラグでグループ化文字が抑止されていない場合、
            (もし存在するなら)数値埋め文字が追加される前にグループ化文字が
            挿入されます。グループ化文字は数値埋め文字には適用されません。
            たとえ数値埋め文字が数字であったとしても同様です。
           </p>
           <p class="para">
            位置あわせを確実にするため、出力中の数値の前後に表れる文字(たとえば
            通貨記号や符号など)は、必要に応じて(正の数と負の数の長さをそろえるなど
            の理由で)スペース文字が付加されることがあります。
           </p>
          </dd>

         
        </dl>

       </p>
      </p>
      <p class="formalpara">
       <h5 class="title">
        右精度
       </h5>
       <p class="para">
        <dl>

         
          <dt>
<em>.</em><span class="replaceable">p</span></dt>

          <dd>

           <p class="para">
            ピリオドに続く数値(<span class="replaceable">p</span>)
            で、10 進の基準文字以降の桁数を指定します。
            <span class="replaceable">p</span> の値が 0(ゼロ)であった場合、基準文字と
            それ以降の数値は省略されます。右精度が指定されていない場合、
            使用中の現在のロケールからデフォルト値を検出します。
            フォーマットされる数値は、フォーマット前にこの桁数に丸められます。
           </p>
          </dd>

         
        </dl>

       </p>
      </p>
      <p class="formalpara">
       <h5 class="title">
        変換文字
       </h5>
       <p class="para">
        <dl>

         
          <dt>
<em>i</em></dt>

          <dd>

           <p class="para">
            ロケールの国際通貨フォーマット(例: USA ロケールでは
            USD 1,234.56)によってフォーマットします。
           </p>
          </dd>

         
         
          <dt>
<em>n</em></dt>

          <dd>

           <p class="para">
            ロケールの国内通貨フォーマット(例: de_DE ロケールでは
            EU1.234,56) によってフォーマットします。
           </p>
          </dd>

         
         
          <dt>
<em>%</em></dt>

          <dd>

           <p class="para">
            <em>%</em> 文字を返します。
           </p>
          </dd>

         
        </dl>

       </p>
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">number</code></dt>

     <dd>

      <p class="para">
       フォーマットする数値。
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.money-format-returnvalues">
  <h3 class="title">返り値</h3>
  <p class="para">
   フォーマットした文字列を返します。
   フォーマット文字列の前後の文字は、そのまま返されます。
   <code class="parameter">number</code> が非数値の場合は <strong><code>NULL</code></strong> を返し、
   <strong><code>E_WARNING</code></strong> を発行します。
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.money-format-notes">
  <h3 class="title">注意</h3>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    システムで strfmon が使用可能な場合のみ <span class="function"><strong>money_format()</strong></span>
    関数が定義されます。例えば、Windows では strfmon は使用できません。
    そのため <span class="function"><strong>money_format()</strong></span> は Windows では
    定義されていません。
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">注意</strong>: 
   <p class="para">
    ロケール設定のうち、<strong><code>LC_MONETARY</code></strong> カテゴリの内容が
    この関数の振る舞いに影響します。この関数を使用する前に、
    <span class="function"><a href="function.setlocale.html" class="function">setlocale()</a></span> で適切なデフォルトロケールを
    設定してください。
   </p>
  </p></blockquote>   
 </div>


 <div class="refsect1 examples" id="refsect1-function.money-format-examples">
  <h3 class="title">例</h3>
  <p class="para">
   <div class="example" id="hex2bin.example.basic">
    <p><strong>例1 <span class="function"><strong>money_format()</strong></span> の例</strong></p>
    <div class="example-contents"><p>
     この関数の使用法を詳しく説明するために、
     さまざまなロケールおよびフォーマット指定を使用します。
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$number&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1234.56</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;en_US&nbsp;ロケールの国際フォーマットで表示します<br /></span><span style="color: #0000BB">setlocale</span><span style="color: #007700">(</span><span style="color: #0000BB">LC_MONETARY</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'en_US'</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">money_format</span><span style="color: #007700">(</span><span style="color: #DD0000">'%i'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$number</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">//&nbsp;USD&nbsp;1,234.56<br /><br />//&nbsp;イタリアの国内フォーマットで小数点以下&nbsp;2&nbsp;桁で表示します<br /></span><span style="color: #0000BB">setlocale</span><span style="color: #007700">(</span><span style="color: #0000BB">LC_MONETARY</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'it_IT'</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">money_format</span><span style="color: #007700">(</span><span style="color: #DD0000">'%.2n'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$number</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">//&nbsp;Eu&nbsp;1.234,56<br /><br />//&nbsp;負の数を使用します<br /></span><span style="color: #0000BB">$number&nbsp;</span><span style="color: #007700">=&nbsp;-</span><span style="color: #0000BB">1234.5672</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;US&nbsp;の国際フォーマットで、負の数には&nbsp;()&nbsp;を使用して<br />//&nbsp;左精度を&nbsp;10&nbsp;桁にします<br /></span><span style="color: #0000BB">setlocale</span><span style="color: #007700">(</span><span style="color: #0000BB">LC_MONETARY</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'en_US'</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">money_format</span><span style="color: #007700">(</span><span style="color: #DD0000">'%(#10n'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$number</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">//&nbsp;($&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,234.57)<br /><br />//&nbsp;上と同じですが、それに加えて右精度を&nbsp;2&nbsp;桁<br />//&nbsp;数値埋め文字として&nbsp;'*'&nbsp;を使用します<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">money_format</span><span style="color: #007700">(</span><span style="color: #DD0000">'%=*(#10.2n'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$number</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">//&nbsp;($********1,234.57)<br /><br />//&nbsp;左詰め、幅&nbsp;14&nbsp;桁、左精度&nbsp;8&nbsp;桁、右精度&nbsp;2&nbsp;桁、グループ化文字なしで<br />//&nbsp;de_DE&nbsp;ロケールの国際フォーマットを使用します。<br /></span><span style="color: #0000BB">setlocale</span><span style="color: #007700">(</span><span style="color: #0000BB">LC_MONETARY</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'de_DE'</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #0000BB">money_format</span><span style="color: #007700">(</span><span style="color: #DD0000">'%=*^-14#8.2i'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1234.56</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">//&nbsp;Eu&nbsp;1234,56****<br /><br />//&nbsp;変換指定の前後に宣伝文句を追加します<br /></span><span style="color: #0000BB">setlocale</span><span style="color: #007700">(</span><span style="color: #0000BB">LC_MONETARY</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'en_GB'</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$fmt&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'The&nbsp;final&nbsp;value&nbsp;is&nbsp;%i&nbsp;(after&nbsp;a&nbsp;10%%&nbsp;discount)'</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #0000BB">money_format</span><span style="color: #007700">(</span><span style="color: #0000BB">$fmt</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">1234.56</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">//&nbsp;The&nbsp;final&nbsp;value&nbsp;is&nbsp;&nbsp;GBP&nbsp;1,234.56&nbsp;(after&nbsp;a&nbsp;10%&nbsp;discount)<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.money-format-seealso">
  <h3 class="title">参考</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.setlocale.html" class="function" rel="rdfs-seeAlso">setlocale()</a> - ロケール情報を設定する</span></li>
    <li class="member"><span class="function"><a href="function.sscanf.html" class="function" rel="rdfs-seeAlso">sscanf()</a> - フォーマット文字列に基づき入力を処理する</span></li>
    <li class="member"><span class="function"><a href="function.sprintf.html" class="function" rel="rdfs-seeAlso">sprintf()</a> - フォーマットされた文字列を返す</span></li>
    <li class="member"><span class="function"><a href="function.printf.html" class="function" rel="rdfs-seeAlso">printf()</a> - フォーマット済みの文字列を出力する</span></li>
    <li class="member"><span class="function"><a href="function.number-format.html" class="function" rel="rdfs-seeAlso">number_format()</a> - 数字を千位毎にグループ化してフォーマットする</span></li>
   </ul>
  </p>
 </div>


</div><div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="121312""></a>
  <div class="note">
   <strong class="user">justsomeone</strong>
   <a href="#121312" class="date">04-Jul-2017 08:49</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Using the money_format function with float values which have more than two decimal digits can result in rounding errors. <br />
Maybe this function will help you to avoid these failures:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="comment">// A product with a base price of 12.95<br />
</span><span class="default">$price </span><span class="keyword">= </span><span class="default">1295</span><span class="keyword">;<br />
<br />
</span><span class="comment">// The quantity is also an integer but translated it would be 11.91<br />
</span><span class="default">$quantity </span><span class="keyword">= </span><span class="default">1191</span><span class="keyword">;<br />
<br />
</span><span class="comment">// Result: 154.2345<br />
// It's the same like 12.95 * 11.91<br />
</span><span class="default">$sum </span><span class="keyword">= (</span><span class="default">$price </span><span class="keyword">/ </span><span class="default">100</span><span class="keyword">) * (</span><span class="default">$quantity&nbsp; </span><span class="keyword">/</span><span class="default">100</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Wrong result: 154.23<br />
</span><span class="default">money_format</span><span class="keyword">(</span><span class="string">'%!i'</span><span class="keyword">, </span><span class="default">$sum</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Wrong result: 154.23<br />
</span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$sum</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Wrong result: 154.23<br />
</span><span class="default">bcmul</span><span class="keyword">(</span><span class="default">$price </span><span class="keyword">/ </span><span class="default">100</span><span class="keyword">, </span><span class="default">$quantity </span><span class="keyword">/ </span><span class="default">100</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br />
<br />
</span><span class="comment">// Correct result : 154.24<br />
</span><span class="default">money_format_rounded</span><span class="keyword">(</span><span class="string">'%!i'</span><span class="keyword">, </span><span class="default">$sum</span><span class="keyword">);<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Formats a number as a currency string. Rounds every decimal digit to a defined precision on its own.<br />
&nbsp;*<br />
&nbsp;* @param string $format The format for the money_format function<br />
&nbsp;* @param float|int|string $number The number to be formatted<br />
&nbsp;* @param int $maxPrecision Round up to the $maxPrecision number of decimal digit. Default is: 2<br />
&nbsp;* @param int $roundingType Rounding type for the round function. Default is: \PHP_ROUND_HALF_UP<br />
&nbsp;*<br />
&nbsp;* @return string<br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">money_format_rounded</span><span class="keyword">(</span><span class="default">$format</span><span class="keyword">, </span><span class="default">$number</span><span class="keyword">, </span><span class="default">$maxPrecision </span><span class="keyword">= </span><span class="default">2</span><span class="keyword">, </span><span class="default">$roundingType </span><span class="keyword">= \</span><span class="default">PHP_ROUND_HALF_UP</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$strlen </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$strlen </span><span class="keyword">=== </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">money_format</span><span class="keyword">(</span><span class="default">$format</span><span class="keyword">, </span><span class="default">$number</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$length </span><span class="keyword">= </span><span class="default">$strlen </span><span class="keyword">- </span><span class="default">strrpos</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">, </span><span class="string">'.'</span><span class="keyword">) - </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$length </span><span class="keyword">&lt;= </span><span class="default">0</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">money_format</span><span class="keyword">(</span><span class="default">$format</span><span class="keyword">, </span><span class="default">$number</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rounded </span><span class="keyword">= </span><span class="default">$number</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= --</span><span class="default">$length</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&gt;= </span><span class="default">$maxPrecision</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">--) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rounded </span><span class="keyword">= </span><span class="default">round</span><span class="keyword">(</span><span class="default">$rounded</span><span class="keyword">, </span><span class="default">$i</span><span class="keyword">, </span><span class="default">$roundingType</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">money_format</span><span class="keyword">(</span><span class="default">$format</span><span class="keyword">, </span><span class="default">$rounded</span><span class="keyword">);<br />
}</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120479""></a>
  <div class="note">
   <strong class="user">jonah at jonah dot name</strong>
   <a href="#120479" class="date">19-Jan-2017 08:08</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Be careful when using money_format with rounding.&nbsp; It uses floating-point numbers to round, so the precision is not perfect.&nbsp; Specifically, rounding over 63.5 may be incorrectly rounded down.&nbsp; See the bug report here:<br />
<br />
https://bugs.php.net/bug.php?id=61787<br />
<br />
Bearing this in mind, I'd recommend using <a href="http://php.net/round on your number first." rel="nofollow" target="_blank">http://php.net/round on your number first.</a><br />
<br />
$number = 64.005;<br />
echo money_format('%.2n', $number); // $65.00 (incorrect behavior for PHP_ROUND_HALF_UP)<br />
<br />
$number2 = round($number, 2);<br />
echo money_format('%.2n', $number2); // $65.01 (correct)</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="119530""></a>
  <div class="note">
   <strong class="user">Felix Duterloo</strong>
   <a href="#119530" class="date">30-Jun-2016 09:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Improvement to Rafael M. Salvioni's solution for money_format on Windows: when no currency symbol is selected, in the formatting, the minus sign was also lost when the locale puts it in position 3 or 4. Changed $currency = '';&nbsp; to: $currency = $cprefix .$csuffix;<br />
<br />
function money_format($format, $number) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $regex = '/%((?:[\^!\-]|\+|\(|\=.)*)([0-9]+)?' .<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; '(?:#([0-9]+))?(?:\.([0-9]+))?([in%])/';<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (setlocale(LC_MONETARY, 0) == 'C') {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; setlocale(LC_MONETARY, '');<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; $locale = localeconv();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; preg_match_all($regex, $format, $matches, PREG_SET_ORDER);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; foreach ($matches as $fmatch) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $value = floatval($number);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $flags = array(<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'fillchar' =&gt; preg_match('/\=(.)/', $fmatch[1], $match) ?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $match[1] : ' ',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'nogroup' =&gt; preg_match('/\^/', $fmatch[1]) &gt; 0,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'usesignal' =&gt; preg_match('/\+|\(/', $fmatch[1], $match) ?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $match[0] : '+',<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'nosimbol' =&gt; preg_match('/\!/', $fmatch[1]) &gt; 0,<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 'isleft' =&gt; preg_match('/\-/', $fmatch[1]) &gt; 0<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; );<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $width = trim($fmatch[2]) ? (int) $fmatch[2] : 0;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $left = trim($fmatch[3]) ? (int) $fmatch[3] : 0;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $right = trim($fmatch[4]) ? (int) $fmatch[4] : $locale['int_frac_digits'];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $conversion = $fmatch[5];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $positive = true;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($value &lt; 0) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $positive = false;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $value *= -1;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $letter = $positive ? 'p' : 'n';<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $prefix = $suffix = $cprefix = $csuffix = $signal = '';<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $signal = $positive ? $locale['positive_sign'] : $locale['negative_sign'];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; switch (true) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case $locale["{$letter}_sign_posn"] == 1 &amp;&amp; $flags['usesignal'] == '+':<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $prefix = $signal;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case $locale["{$letter}_sign_posn"] == 2 &amp;&amp; $flags['usesignal'] == '+':<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $suffix = $signal;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case $locale["{$letter}_sign_posn"] == 3 &amp;&amp; $flags['usesignal'] == '+':<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $cprefix = $signal;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case $locale["{$letter}_sign_posn"] == 4 &amp;&amp; $flags['usesignal'] == '+':<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $csuffix = $signal;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case $flags['usesignal'] == '(':<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case $locale["{$letter}_sign_posn"] == 0:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $prefix = '(';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $suffix = ')';<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (!$flags['nosimbol']) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $currency = $cprefix .<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; ($conversion == 'i' ? $locale['int_curr_symbol'] : $locale['currency_symbol']) .<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $csuffix;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $currency = $cprefix .$csuffix;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $space = $locale["{$letter}_sep_by_space"] ? ' ' : '';<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $value = number_format($value, $right, $locale['mon_decimal_point'], $flags['nogroup'] ? '' : $locale['mon_thousands_sep']);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $value = @explode($locale['mon_decimal_point'], $value);<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $n = strlen($prefix) + strlen($currency) + strlen($value[0]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($left &gt; 0 &amp;&amp; $left &gt; $n) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $value[0] = str_repeat($flags['fillchar'], $left - $n) . $value[0];<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $value = implode($locale['mon_decimal_point'], $value);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($locale["{$letter}_cs_precedes"]) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $value = $prefix . $currency . $space . $value . $suffix;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $value = $prefix . $value . $space . $currency . $suffix;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if ($width &gt; 0) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $value = str_pad($value, $width, $flags['fillchar'], $flags['isleft'] ?<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; STR_PAD_RIGHT : STR_PAD_LEFT);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; $format = str_replace($fmatch[0], $value, $format);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return $format;<br />
&nbsp;&nbsp;&nbsp; }</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="116725""></a>
  <div class="note">
   <strong class="user">tim</strong>
   <a href="#116725" class="date">20-Feb-2015 07:21</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
For most of us in the US, we don't want to see a "USD" for our currency symbol, so '%i' doesn't cut it.&nbsp; Here's what I used that worked to get what most&nbsp; people expect to see for a number format.<br />
<br />
$number = 123.4<br />
setlocale(LC_MONETARY, 'en_US.UTF-8');<br />
money_format('%.2n', $number);<br />
<br />
output:<br />
$123.40<br />
<br />
That gives me a dollar sign at the beginning, and 2 digits at the end.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="115202""></a>
  <div class="note">
   <strong class="user">kaigillmann at googlemail dot com</strong>
   <a href="#115202" class="date">12-Jun-2014 04:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you get "EUR" instead of the euro symbol, set the locale to utf8 charset like this:<br />
<br />
<span class="default">&lt;?php<br />
setlocale</span><span class="keyword">(</span><span class="default">LC_MONETARY</span><span class="keyword">, </span><span class="string">'de_DE.utf8'</span><span class="keyword">);<br />
echo </span><span class="default">money_format</span><span class="keyword">(</span><span class="string">'%+n'</span><span class="keyword">, </span><span class="default">1234.56</span><span class="keyword">);<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="114074""></a>
  <div class="note">
   <strong class="user">todoventas at xarxa-cat dot net</strong>
   <a href="#114074" class="date">09-Jan-2014 12:27</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
In Rafael M. Salvioni function localeconv(); returns an invalid array in my Windows XP SP3 running PHP 5.4.13 so to prevent the Warning Message: implode(): Invalid arguments passed i just add the $locale manually. For other languages just fill the array with the correct settings.<br />
<br />
&lt;?<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; $locale = array(<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'decimal_point'&nbsp; &nbsp; &nbsp; &nbsp; =&gt; '.',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'thousands_sep'&nbsp; &nbsp; &nbsp; &nbsp; =&gt; '',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'int_curr_symbol'&nbsp; &nbsp; =&gt; 'EUR',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'currency_symbol'&nbsp; &nbsp; =&gt; '?',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'mon_decimal_point'&nbsp; &nbsp; =&gt; ',',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'mon_thousands_sep'&nbsp; &nbsp; =&gt; '.',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'positive_sign'&nbsp; &nbsp; &nbsp; &nbsp; =&gt; '',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'negative_sign'&nbsp; &nbsp;&nbsp; =&gt; '-',<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'int_frac_digits'&nbsp; &nbsp; =&gt; 2,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'frac_digits'&nbsp; &nbsp; &nbsp; &nbsp; =&gt; 2,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'p_cs_precedes'&nbsp; &nbsp; &nbsp; &nbsp; =&gt; 0,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'p_sep_by_space'&nbsp; &nbsp; =&gt; 1,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'p_sign_posn'&nbsp; &nbsp; &nbsp; &nbsp; =&gt; 1,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'n_sign_posn'&nbsp; &nbsp; &nbsp; &nbsp; =&gt; 1,<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'grouping'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; =&gt; array(),<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 'mon_grouping'&nbsp; &nbsp; &nbsp; &nbsp; =&gt; array(0 =&gt; 3, 1 =&gt; 3)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; );<br />
?&gt;</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="112890""></a>
  <div class="note">
   <strong class="user">jsb17NO at SPAMcornell dot edu</strong>
   <a href="#112890" class="date">03-Aug-2013 05:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
To drop zero value decimals, use the following:<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">/*<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; Same as php number_format(), but if ends in .0, .00, .000, etc... , drops the decimals altogether<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; Returns string type, rounded number - same as php number_format()):<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; Examples:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; number_format_drop_zero_decimals(54.378, 2) ==&gt; '54.38'<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; number_format_drop_zero_decimals(54.00, 2) ==&gt; '54'<br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">number_format_drop_zero_decimals</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">, </span><span class="default">$n_decimals</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return ((</span><span class="default">floor</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">) == </span><span class="default">round</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">, </span><span class="default">$n_decimals</span><span class="keyword">)) ? </span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">) : </span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">, </span><span class="default">$n_decimals</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;<br />
</span>Results:<br />
number_format_drop_zero_decimals(54.377, 2) ==&gt; 54.38<br />
number_format_drop_zero_decimals('54.377', 2) ==&gt; 54.38<br />
number_format_drop_zero_decimals(54.377, 3) ==&gt; 54.377<br />
number_format_drop_zero_decimals(54.007, 2) ==&gt; 54.01<br />
number_format_drop_zero_decimals(54.000, 2) ==&gt; 54<br />
number_format_drop_zero_decimals(54.00, 2) ==&gt; 54<br />
number_format_drop_zero_decimals(54.0, 2) ==&gt; 54<br />
number_format_drop_zero_decimals(54.1, 2) ==&gt; 54.10<br />
number_format_drop_zero_decimals(54., 2) ==&gt; 54<br />
number_format_drop_zero_decimals(54, 2) ==&gt; 54<br />
number_format_drop_zero_decimals(54, 3) ==&gt; 54<br />
number_format_drop_zero_decimals(54 + .13, 2) ==&gt; 54.13<br />
number_format_drop_zero_decimals(54 + .00, 2) ==&gt; 54<br />
number_format_drop_zero_decimals(54.0007, 4) ==&gt; 54.0007<br />
number_format_drop_zero_decimals(54.0007, 3) ==&gt; 54.001<br />
number_format_drop_zero_decimals(54.00007, 3) ==&gt; 54&nbsp; //&nbsp; take notice</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="109762""></a>
  <div class="note">
   <strong class="user">~B</strong>
   <a href="#109762" class="date">18-Aug-2012 01:58</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
We found that after switching from Ubuntu 10.04 php -v 5.3.2, to Ubuntu 12.04 php -v 5.3.10 this no longer worked:
<br />

<br />
<span class="default">&lt;?php setlocale</span><span class="keyword">(</span><span class="default">LC_MONETARY</span><span class="keyword">, </span><span class="string">'en_US'</span><span class="keyword">); </span><span class="default">?&gt;
<br />
</span>
<br />
Found that using:
<br />

<br />
<span class="default">&lt;?php setlocale</span><span class="keyword">(</span><span class="default">LC_MONETARY</span><span class="keyword">, </span><span class="string">'en_US.UTF-8'</span><span class="keyword">); </span><span class="default">?&gt;
<br />
</span>
<br />
worked find</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="105961""></a>
  <div class="note">
   <strong class="user">phpdeveloperbalaji at gmail dot com</strong>
   <a href="#105961" class="date">28-Sep-2011 10:04</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Hi,
<br />

<br />
For South Asian Currencies, this function could be a handy one.
<br />

<br />
It will handle negative as well as float(Paise).
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">my_money_format</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">strstr</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">,</span><span class="string">"-"</span><span class="keyword">))
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$number </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">"-"</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="default">$number</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$negative </span><span class="keyword">= </span><span class="string">"-"</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$split_number </span><span class="keyword">= @</span><span class="default">explode</span><span class="keyword">(</span><span class="string">"."</span><span class="keyword">,</span><span class="default">$number</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$rupee </span><span class="keyword">= </span><span class="default">$split_number</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$paise </span><span class="keyword">= @</span><span class="default">$split_number</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">];
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; if(@</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$rupee</span><span class="keyword">)&gt;</span><span class="default">3</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$hundreds </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$rupee</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$rupee</span><span class="keyword">)-</span><span class="default">3</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$thousands_in_reverse </span><span class="keyword">= </span><span class="default">strrev</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$rupee</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$rupee</span><span class="keyword">)-</span><span class="default">3</span><span class="keyword">));
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$thousands_in_reverse</span><span class="keyword">)); </span><span class="default">$i</span><span class="keyword">=</span><span class="default">$i</span><span class="keyword">+</span><span class="default">2</span><span class="keyword">)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$thousands </span><span class="keyword">.= </span><span class="default">$thousands_in_reverse</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].</span><span class="default">$thousands_in_reverse</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">].</span><span class="string">","</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$thousands </span><span class="keyword">= </span><span class="default">strrev</span><span class="keyword">(</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$thousands</span><span class="keyword">,</span><span class="string">","</span><span class="keyword">));
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$formatted_rupee </span><span class="keyword">= </span><span class="default">$thousands</span><span class="keyword">.</span><span class="string">","</span><span class="keyword">.</span><span class="default">$hundreds</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; else
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$formatted_rupee </span><span class="keyword">= </span><span class="default">$rupee</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; if((int)</span><span class="default">$paise</span><span class="keyword">&gt;</span><span class="default">0</span><span class="keyword">)
<br />
&nbsp;&nbsp;&nbsp; {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$formatted_paise </span><span class="keyword">= </span><span class="string">"."</span><span class="keyword">.</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$paise</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$negative</span><span class="keyword">.</span><span class="default">$formatted_rupee</span><span class="keyword">.</span><span class="default">$formatted_paise</span><span class="keyword">;
<br />

<br />
}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
Thanks,</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="98783""></a>
  <div class="note">
   <strong class="user">andrey.dobrozhanskiy [-a-t-] gmail com</strong>
   <a href="#98783" class="date">07-Jul-2010 06:43</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This function divides integer value by commas. F.e.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">echo </span><span class="default">formatMoney</span><span class="keyword">(</span><span class="default">1050</span><span class="keyword">); </span><span class="comment"># 1,050
<br />
</span><span class="keyword">echo </span><span class="default">formatMoney</span><span class="keyword">(</span><span class="default">1321435.4</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">); </span><span class="comment"># 1,321,435.40
<br />
</span><span class="keyword">echo </span><span class="default">formatMoney</span><span class="keyword">(</span><span class="default">10059240.42941</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">); </span><span class="comment"># 10,059,240.43
<br />
</span><span class="keyword">echo </span><span class="default">formatMoney</span><span class="keyword">(</span><span class="default">13245</span><span class="keyword">); </span><span class="comment"># 13,245
<br />

<br />
</span><span class="keyword">function </span><span class="default">formatMoney</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">, </span><span class="default">$fractional</span><span class="keyword">=</span><span class="default">false</span><span class="keyword">) {
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$fractional</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$number </span><span class="keyword">= </span><span class="default">sprintf</span><span class="keyword">(</span><span class="string">'%.2f'</span><span class="keyword">, </span><span class="default">$number</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; while (</span><span class="default">true</span><span class="keyword">) { 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$replaced </span><span class="keyword">= </span><span class="default">preg_replace</span><span class="keyword">(</span><span class="string">'/(-?\d+)(\d\d\d)/'</span><span class="keyword">, </span><span class="string">'$1,$2'</span><span class="keyword">, </span><span class="default">$number</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$replaced </span><span class="keyword">!= </span><span class="default">$number</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$number </span><span class="keyword">= </span><span class="default">$replaced</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$number</span><span class="keyword">;
<br />
}
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="89060""></a>
  <div class="note">
   <strong class="user">Rafael M. Salvioni</strong>
   <a href="#89060" class="date">19-Feb-2009 09:20</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a some function posted before, however various bugs were corrected.
<br />

<br />
Thank you to Stuart Roe by reporting the bug on printing signals.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">/*
<br />
That it is an implementation of the function money_format for the
<br />
platforms that do not it bear.&nbsp; 
<br />

<br />
The function accepts to same string of format accepts for the
<br />
original function of the PHP.&nbsp; 
<br />

<br />
(Sorry. my writing in English is very bad)&nbsp; 
<br />

<br />
The function is tested using PHP 5.1.4 in Windows XP
<br />
and Apache WebServer.
<br />
*/
<br />
</span><span class="keyword">function </span><span class="default">money_format</span><span class="keyword">(</span><span class="default">$format</span><span class="keyword">, </span><span class="default">$number</span><span class="keyword">)
<br />
{
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$regex&nbsp; </span><span class="keyword">= </span><span class="string">'/%((?:[\^!\-]|\+|\(|\=.)*)([0-9]+)?'</span><span class="keyword">.
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'(?:#([0-9]+))?(?:\.([0-9]+))?([in%])/'</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">setlocale</span><span class="keyword">(</span><span class="default">LC_MONETARY</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">) == </span><span class="string">'C'</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">setlocale</span><span class="keyword">(</span><span class="default">LC_MONETARY</span><span class="keyword">, </span><span class="string">''</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$locale </span><span class="keyword">= </span><span class="default">localeconv</span><span class="keyword">();
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">preg_match_all</span><span class="keyword">(</span><span class="default">$regex</span><span class="keyword">, </span><span class="default">$format</span><span class="keyword">, </span><span class="default">$matches</span><span class="keyword">, </span><span class="default">PREG_SET_ORDER</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; foreach (</span><span class="default">$matches </span><span class="keyword">as </span><span class="default">$fmatch</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">floatval</span><span class="keyword">(</span><span class="default">$number</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$flags </span><span class="keyword">= array(
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'fillchar'&nbsp; </span><span class="keyword">=&gt; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/\=(.)/'</span><span class="keyword">, </span><span class="default">$fmatch</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">$match</span><span class="keyword">) ?
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$match</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">] : </span><span class="string">' '</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'nogroup'&nbsp;&nbsp; </span><span class="keyword">=&gt; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/\^/'</span><span class="keyword">, </span><span class="default">$fmatch</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]) &gt; </span><span class="default">0</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'usesignal' </span><span class="keyword">=&gt; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/\+|\(/'</span><span class="keyword">, </span><span class="default">$fmatch</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">], </span><span class="default">$match</span><span class="keyword">) ?
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$match</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] : </span><span class="string">'+'</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'nosimbol'&nbsp; </span><span class="keyword">=&gt; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/\!/'</span><span class="keyword">, </span><span class="default">$fmatch</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]) &gt; </span><span class="default">0</span><span class="keyword">,
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="string">'isleft'&nbsp; &nbsp; </span><span class="keyword">=&gt; </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/\-/'</span><span class="keyword">, </span><span class="default">$fmatch</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]) &gt; </span><span class="default">0
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$width&nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$fmatch</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]) ? (int)</span><span class="default">$fmatch</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">] : </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$left&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$fmatch</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">]) ? (int)</span><span class="default">$fmatch</span><span class="keyword">[</span><span class="default">3</span><span class="keyword">] : </span><span class="default">0</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$right&nbsp; &nbsp; &nbsp; </span><span class="keyword">= </span><span class="default">trim</span><span class="keyword">(</span><span class="default">$fmatch</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">]) ? (int)</span><span class="default">$fmatch</span><span class="keyword">[</span><span class="default">4</span><span class="keyword">] : </span><span class="default">$locale</span><span class="keyword">[</span><span class="string">'int_frac_digits'</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$conversion </span><span class="keyword">= </span><span class="default">$fmatch</span><span class="keyword">[</span><span class="default">5</span><span class="keyword">];
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$positive </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$value </span><span class="keyword">&lt; </span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$positive </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value&nbsp; </span><span class="keyword">*= -</span><span class="default">1</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$letter </span><span class="keyword">= </span><span class="default">$positive </span><span class="keyword">? </span><span class="string">'p' </span><span class="keyword">: </span><span class="string">'n'</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$prefix </span><span class="keyword">= </span><span class="default">$suffix </span><span class="keyword">= </span><span class="default">$cprefix </span><span class="keyword">= </span><span class="default">$csuffix </span><span class="keyword">= </span><span class="default">$signal </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$signal </span><span class="keyword">= </span><span class="default">$positive </span><span class="keyword">? </span><span class="default">$locale</span><span class="keyword">[</span><span class="string">'positive_sign'</span><span class="keyword">] : </span><span class="default">$locale</span><span class="keyword">[</span><span class="string">'negative_sign'</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; switch (</span><span class="default">true</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">$locale</span><span class="keyword">[</span><span class="string">"</span><span class="keyword">{</span><span class="default">$letter</span><span class="keyword">}</span><span class="string">_sign_posn"</span><span class="keyword">] == </span><span class="default">1 </span><span class="keyword">&amp;&amp; </span><span class="default">$flags</span><span class="keyword">[</span><span class="string">'usesignal'</span><span class="keyword">] == </span><span class="string">'+'</span><span class="keyword">:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$prefix </span><span class="keyword">= </span><span class="default">$signal</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">$locale</span><span class="keyword">[</span><span class="string">"</span><span class="keyword">{</span><span class="default">$letter</span><span class="keyword">}</span><span class="string">_sign_posn"</span><span class="keyword">] == </span><span class="default">2 </span><span class="keyword">&amp;&amp; </span><span class="default">$flags</span><span class="keyword">[</span><span class="string">'usesignal'</span><span class="keyword">] == </span><span class="string">'+'</span><span class="keyword">:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$suffix </span><span class="keyword">= </span><span class="default">$signal</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">$locale</span><span class="keyword">[</span><span class="string">"</span><span class="keyword">{</span><span class="default">$letter</span><span class="keyword">}</span><span class="string">_sign_posn"</span><span class="keyword">] == </span><span class="default">3 </span><span class="keyword">&amp;&amp; </span><span class="default">$flags</span><span class="keyword">[</span><span class="string">'usesignal'</span><span class="keyword">] == </span><span class="string">'+'</span><span class="keyword">:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cprefix </span><span class="keyword">= </span><span class="default">$signal</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">$locale</span><span class="keyword">[</span><span class="string">"</span><span class="keyword">{</span><span class="default">$letter</span><span class="keyword">}</span><span class="string">_sign_posn"</span><span class="keyword">] == </span><span class="default">4 </span><span class="keyword">&amp;&amp; </span><span class="default">$flags</span><span class="keyword">[</span><span class="string">'usesignal'</span><span class="keyword">] == </span><span class="string">'+'</span><span class="keyword">:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$csuffix </span><span class="keyword">= </span><span class="default">$signal</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">$flags</span><span class="keyword">[</span><span class="string">'usesignal'</span><span class="keyword">] == </span><span class="string">'('</span><span class="keyword">:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">$locale</span><span class="keyword">[</span><span class="string">"</span><span class="keyword">{</span><span class="default">$letter</span><span class="keyword">}</span><span class="string">_sign_posn"</span><span class="keyword">] == </span><span class="default">0</span><span class="keyword">:
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$prefix </span><span class="keyword">= </span><span class="string">'('</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$suffix </span><span class="keyword">= </span><span class="string">')'</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (!</span><span class="default">$flags</span><span class="keyword">[</span><span class="string">'nosimbol'</span><span class="keyword">]) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$currency </span><span class="keyword">= </span><span class="default">$cprefix </span><span class="keyword">.
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; (</span><span class="default">$conversion </span><span class="keyword">== </span><span class="string">'i' </span><span class="keyword">? </span><span class="default">$locale</span><span class="keyword">[</span><span class="string">'int_curr_symbol'</span><span class="keyword">] : </span><span class="default">$locale</span><span class="keyword">[</span><span class="string">'currency_symbol'</span><span class="keyword">]) .
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$csuffix</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$currency </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$space&nbsp; </span><span class="keyword">= </span><span class="default">$locale</span><span class="keyword">[</span><span class="string">"</span><span class="keyword">{</span><span class="default">$letter</span><span class="keyword">}</span><span class="string">_sep_by_space"</span><span class="keyword">] ? </span><span class="string">' ' </span><span class="keyword">: </span><span class="string">''</span><span class="keyword">;
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">number_format</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="default">$right</span><span class="keyword">, </span><span class="default">$locale</span><span class="keyword">[</span><span class="string">'mon_decimal_point'</span><span class="keyword">],
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$flags</span><span class="keyword">[</span><span class="string">'nogroup'</span><span class="keyword">] ? </span><span class="string">'' </span><span class="keyword">: </span><span class="default">$locale</span><span class="keyword">[</span><span class="string">'mon_thousands_sep'</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= @</span><span class="default">explode</span><span class="keyword">(</span><span class="default">$locale</span><span class="keyword">[</span><span class="string">'mon_decimal_point'</span><span class="keyword">], </span><span class="default">$value</span><span class="keyword">);
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$n </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$prefix</span><span class="keyword">) + </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$currency</span><span class="keyword">) + </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$left </span><span class="keyword">&gt; </span><span class="default">0 </span><span class="keyword">&amp;&amp; </span><span class="default">$left </span><span class="keyword">&gt; </span><span class="default">$n</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">] = </span><span class="default">str_repeat</span><span class="keyword">(</span><span class="default">$flags</span><span class="keyword">[</span><span class="string">'fillchar'</span><span class="keyword">], </span><span class="default">$left </span><span class="keyword">- </span><span class="default">$n</span><span class="keyword">) . </span><span class="default">$value</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">];
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="default">$locale</span><span class="keyword">[</span><span class="string">'mon_decimal_point'</span><span class="keyword">], </span><span class="default">$value</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$locale</span><span class="keyword">[</span><span class="string">"</span><span class="keyword">{</span><span class="default">$letter</span><span class="keyword">}</span><span class="string">_cs_precedes"</span><span class="keyword">]) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">$prefix </span><span class="keyword">. </span><span class="default">$currency </span><span class="keyword">. </span><span class="default">$space </span><span class="keyword">. </span><span class="default">$value </span><span class="keyword">. </span><span class="default">$suffix</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">$prefix </span><span class="keyword">. </span><span class="default">$value </span><span class="keyword">. </span><span class="default">$space </span><span class="keyword">. </span><span class="default">$currency </span><span class="keyword">. </span><span class="default">$suffix</span><span class="keyword">;
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$width </span><span class="keyword">&gt; </span><span class="default">0</span><span class="keyword">) {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= </span><span class="default">str_pad</span><span class="keyword">(</span><span class="default">$value</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$flags</span><span class="keyword">[</span><span class="string">'fillchar'</span><span class="keyword">], </span><span class="default">$flags</span><span class="keyword">[</span><span class="string">'isleft'</span><span class="keyword">] ?
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">STR_PAD_RIGHT </span><span class="keyword">: </span><span class="default">STR_PAD_LEFT</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$format </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="default">$fmatch</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">], </span><span class="default">$value</span><span class="keyword">, </span><span class="default">$format</span><span class="keyword">);
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$format</span><span class="keyword">;
<br />
}
<br />

<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="86039""></a>
  <div class="note">
   <strong class="user">jeremy</strong>
   <a href="#86039" class="date">30-Sep-2008 07:41</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If money_format doesn't seem to be working properly, make sure you are defining a valid locale.&nbsp; For example, on Debian, 'en_US' is not a valid locale - you need 'en_US.UTF-8' or 'en_US.ISO-8559-1'.<br />
<br />
This was frustrating me for a while.&nbsp; Debian has a list of valid locales at /usr/share/i18n/SUPPORTED; find yours there if it's not working properly.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="84634""></a>
  <div class="note">
   <strong class="user">swapnet</strong>
   <a href="#84634" class="date">23-Jul-2008 05:24</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Consider formatting currency for some South Asian countries that use ##,##,###.## money format.
<br />
The following code generates something like Rs. 4,54,234.00 and so on.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="keyword">function </span><span class="default">convertcash</span><span class="keyword">(</span><span class="default">$num</span><span class="keyword">, </span><span class="default">$currency</span><span class="keyword">){
<br />
&nbsp;&nbsp;&nbsp; if(</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$num</span><span class="keyword">)&gt;</span><span class="default">3</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$lastthree </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$num</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$num</span><span class="keyword">)-</span><span class="default">3</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$num</span><span class="keyword">));
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$restunits </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$num</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$num</span><span class="keyword">)-</span><span class="default">3</span><span class="keyword">); </span><span class="comment">// extracts the last three digits
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$restunits </span><span class="keyword">= (</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$restunits</span><span class="keyword">)%</span><span class="default">2 </span><span class="keyword">== </span><span class="default">1</span><span class="keyword">)?</span><span class="string">"0"</span><span class="keyword">.</span><span class="default">$restunits</span><span class="keyword">:</span><span class="default">$restunits</span><span class="keyword">; </span><span class="comment">// explodes the remaining digits in 2's formats, adds a zero in the beginning to maintain the 2's grouping.
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$expunit </span><span class="keyword">= </span><span class="default">str_split</span><span class="keyword">(</span><span class="default">$restunits</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">sizeof</span><span class="keyword">(</span><span class="default">$expunit</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++){
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$explrestunits </span><span class="keyword">.= (int)</span><span class="default">$expunit</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">].</span><span class="string">","</span><span class="keyword">; </span><span class="comment">// creates each of the 2's group and adds a comma to the end
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}&nbsp; &nbsp; 
<br />

<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$thecash </span><span class="keyword">= </span><span class="default">$explrestunits</span><span class="keyword">.</span><span class="default">$lastthree</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; } else {
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$thecash </span><span class="keyword">= </span><span class="default">$convertnum</span><span class="keyword">;
<br />
&nbsp;&nbsp;&nbsp; }
<br />
&nbsp;&nbsp;&nbsp; 
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">$currency</span><span class="keyword">.</span><span class="default">$thecash</span><span class="keyword">.</span><span class="string">".00"</span><span class="keyword">; </span><span class="comment">// writes the final format where $currency is the currency symbol.
<br />
</span><span class="keyword">}
<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
now call the function as&nbsp; convertcash($row['price'], 'Rs '); // that's the price from the database I called using an Indian Rupees prefix where the price has to be a plain number format, say something like 454234.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="78315""></a>
  <div class="note">
   <strong class="user">scot from ezyauctionz.co.nz</strong>
   <a href="#78315" class="date">06-Oct-2007 12:10</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is a handy little bit of code I just wrote, as I was not able to find anything else suitable for my situation.
<br />
This will handle monetary values that are passed to the script by a user, to reformat any comma use so that it is not broken when it passes through an input validation system that checks for a float.
<br />

<br />
It is not foolproof, but will handle the common input as most users would input it, such as 1,234,567 (outputs 1234567) or 1,234.00 (outputs 1234.00), even handles 12,34 (outputs 12.34), I expect it would work with negative numbers, but have not tested it, as it is not used for that in my situation.
<br />

<br />
This worked when other options such as money_format() were not suitable or possible.
<br />

<br />
<span class="default">&lt;?php
<br />
</span><span class="comment">///////////////
<br />
// BEGIN CODE convert all price amounts into well formatted values
<br />
</span><span class="keyword">function </span><span class="default">converttonum</span><span class="keyword">(</span><span class="default">$convertnum</span><span class="keyword">,</span><span class="default">$fieldinput</span><span class="keyword">){
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$bits </span><span class="keyword">= </span><span class="default">explode</span><span class="keyword">(</span><span class="string">","</span><span class="keyword">,</span><span class="default">$convertnum</span><span class="keyword">); </span><span class="comment">// split input value up to allow checking
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$first </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$bits</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]); </span><span class="comment">// gets part before first comma (thousands/millions)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$last </span><span class="keyword">= </span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$bits</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">]); </span><span class="comment">// gets part after first comma (thousands (or decimals if incorrectly used by user)
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if (</span><span class="default">$last </span><span class="keyword">&lt;</span><span class="default">3</span><span class="keyword">){ </span><span class="comment">// checks for comma being used as decimal place
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$convertnum </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">","</span><span class="keyword">,</span><span class="string">"."</span><span class="keyword">,</span><span class="default">$convertnum</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else{ </span><span class="comment">// assume comma is a thousands seperator, so remove it
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$convertnum </span><span class="keyword">= </span><span class="default">str_replace</span><span class="keyword">(</span><span class="string">","</span><span class="keyword">,</span><span class="string">""</span><span class="keyword">,</span><span class="default">$convertnum</span><span class="keyword">);
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; 
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$_POST</span><span class="keyword">[</span><span class="default">$fieldinput</span><span class="keyword">] = </span><span class="default">$convertnum</span><span class="keyword">; </span><span class="comment">// redefine the vlaue of the variable, to be the new corrected one
<br />
</span><span class="keyword">}
<br />

<br />
@</span><span class="default">converttonum</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="default">inputone</span><span class="keyword">],</span><span class="string">"inputone"</span><span class="keyword">);
<br />
@</span><span class="default">converttonum</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="default">inputtwo</span><span class="keyword">],</span><span class="string">"inputtwo"</span><span class="keyword">);
<br />
@</span><span class="default">converttonum</span><span class="keyword">(</span><span class="default">$_POST</span><span class="keyword">[</span><span class="default">inputthree</span><span class="keyword">],</span><span class="string">"inputthree"</span><span class="keyword">);
<br />
</span><span class="comment">// END CODE
<br />
//////////////
<br />

<br />
</span><span class="default">?&gt;
<br />
</span>
<br />
This is suitable for the English usage, it may need tweaking to work with other types.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="62024""></a>
  <div class="note">
   <strong class="user">richard dot selby at uk dot clara dot net</strong>
   <a href="#62024" class="date">17-Feb-2006 04:02</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Double check that money_format() is defined on any version of PHP you plan your code to run on.&nbsp; You might be surprised.<br />
<br />
For example, it worked on my Linux box where I code, but not on&nbsp; servers running&nbsp; BSD 4.11 variants. (This is presumably because strfmon&nbsp; is not defined - see note at the top of teis page). It's not just a windows/unix issue.</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.metaphone.html">metaphone</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.nl-langinfo.html">nl_langinfo</a></div>
 <div class="up"><a href="ref.strings.html">String 関数</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
