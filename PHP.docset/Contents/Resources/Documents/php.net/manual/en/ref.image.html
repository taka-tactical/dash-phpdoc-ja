<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; CHARSET=shift-jis">
  <title>GD および Image 関数</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <link media="all" rel="stylesheet" type="text/css" href="style.css"/>
 </head>
 <body class="docs"><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="image.examples.merged-watermark.html">imagecopymerge による半透明なすかしの作成</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.gd-info.html">gd_info</a></div>
 <div class="up"><a href="book.image.html">GD</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="ref.image" class="reference">
 <h1 class="title">GD および Image 関数</h1>

 


























































































































































































































































































































































































































































































































































































































































































































































































































































































































































<h2>目次</h2><ul class="chunklist chunklist_reference"><li><a href="function.gd-info.html">gd_info</a> &mdash; 現在インストールされているGDライブラリに関する情報を取得する</li><li><a href="function.getimagesize.html">getimagesize</a> &mdash; 画像の大きさを取得する</li><li><a href="function.getimagesizefromstring.html">getimagesizefromstring</a> &mdash; 画像の大きさを文字列から取得する</li><li><a href="function.image-type-to-extension.html">image_type_to_extension</a> &mdash; 画像形式からファイルの拡張子を取得する</li><li><a href="function.image-type-to-mime-type.html">image_type_to_mime_type</a> &mdash; getimagesize, exif_read_data, exif_thumbnail, exif_imagetypeから返される
   画像形式のMIMEタイプを取得する</li><li><a href="function.image2wbmp.html">image2wbmp</a> &mdash; 画像をブラウザあるいはファイルに出力する</li><li><a href="function.imageaffine.html">imageaffine</a> &mdash; 元の画像を、オプションのクリッピング領域を使ってアフィン変換した画像を返す</li><li><a href="function.imageaffinematrixconcat.html">imageaffinematrixconcat</a> &mdash; 二つのアフィン変換行列を連結する</li><li><a href="function.imageaffinematrixget.html">imageaffinematrixget</a> &mdash; アフィン変換行列を取得する</li><li><a href="function.imagealphablending.html">imagealphablending</a> &mdash; イメージのブレンドモードを設定する</li><li><a href="function.imageantialias.html">imageantialias</a> &mdash; アンチエイリアス機能を使用すべきかどうかを判断する</li><li><a href="function.imagearc.html">imagearc</a> &mdash; 部分楕円を描画する</li><li><a href="function.imagebmp.html">imagebmp</a> &mdash; Output a BMP image to browser or file</li><li><a href="function.imagechar.html">imagechar</a> &mdash; 水平に文字を描画する</li><li><a href="function.imagecharup.html">imagecharup</a> &mdash; 垂直に文字を描画する</li><li><a href="function.imagecolorallocate.html">imagecolorallocate</a> &mdash; 画像で使用する色を作成する</li><li><a href="function.imagecolorallocatealpha.html">imagecolorallocatealpha</a> &mdash; 画像で使用する色を透過度を指定して作成する</li><li><a href="function.imagecolorat.html">imagecolorat</a> &mdash; ピクセルの色のインデックスを取得する</li><li><a href="function.imagecolorclosest.html">imagecolorclosest</a> &mdash; 指定した色に最も近い色のインデックスを取得する</li><li><a href="function.imagecolorclosestalpha.html">imagecolorclosestalpha</a> &mdash; 指定した色+アルファ値に最も近い色のインデックスを取得する</li><li><a href="function.imagecolorclosesthwb.html">imagecolorclosesthwb</a> &mdash; 色合い、白、黒を有する色のインデックスを得る</li><li><a href="function.imagecolordeallocate.html">imagecolordeallocate</a> &mdash; イメージの色リソースを開放する</li><li><a href="function.imagecolorexact.html">imagecolorexact</a> &mdash; 指定した色のインデックスを取得する</li><li><a href="function.imagecolorexactalpha.html">imagecolorexactalpha</a> &mdash; 指定した色+アルファ値のインデックスを取得する</li><li><a href="function.imagecolormatch.html">imagecolormatch</a> &mdash; パレットイメージの色を True カラーイメージに近づける</li><li><a href="function.imagecolorresolve.html">imagecolorresolve</a> &mdash; 指定した色または出来るだけ近い色のインデックスを得る</li><li><a href="function.imagecolorresolvealpha.html">imagecolorresolvealpha</a> &mdash; 指定した色+アルファ値または最も近い色のインデックスを取得する</li><li><a href="function.imagecolorset.html">imagecolorset</a> &mdash; 指定したパレットインデックスの色を設定する</li><li><a href="function.imagecolorsforindex.html">imagecolorsforindex</a> &mdash; カラーインデックスからカラーを取得する</li><li><a href="function.imagecolorstotal.html">imagecolorstotal</a> &mdash; 画像パレットの色数を検出する</li><li><a href="function.imagecolortransparent.html">imagecolortransparent</a> &mdash; 透明色を定義する</li><li><a href="function.imageconvolution.html">imageconvolution</a> &mdash; div および offset の係数を使用し、3x3 の畳み込み配列を適用する</li><li><a href="function.imagecopy.html">imagecopy</a> &mdash; 画像の一部をコピーする</li><li><a href="function.imagecopymerge.html">imagecopymerge</a> &mdash; イメージの一部をコピー、マージする</li><li><a href="function.imagecopymergegray.html">imagecopymergegray</a> &mdash; グレースケールでイメージの一部をコピー、マージする</li><li><a href="function.imagecopyresampled.html">imagecopyresampled</a> &mdash; 再サンプリングを行いイメージの一部をコピー、伸縮する</li><li><a href="function.imagecopyresized.html">imagecopyresized</a> &mdash; 画像の一部をコピーしサイズを変更する</li><li><a href="function.imagecreate.html">imagecreate</a> &mdash; パレットを使用する新規画像を作成する</li><li><a href="function.imagecreatefrombmp.html">imagecreatefrombmp</a> &mdash; 新しい画像をファイルあるいは URL から作成する</li><li><a href="function.imagecreatefromgd2.html">imagecreatefromgd2</a> &mdash; GD2 ファイルまたは URL から新規イメージを生成する</li><li><a href="function.imagecreatefromgd2part.html">imagecreatefromgd2part</a> &mdash; GD2 ファイルまたは URL の指定した部分から新規イメージを生成する</li><li><a href="function.imagecreatefromgd.html">imagecreatefromgd</a> &mdash; GD ファイルまたは URL から新規イメージを生成する</li><li><a href="function.imagecreatefromgif.html">imagecreatefromgif</a> &mdash; 新しい画像をファイルあるいは URL から作成する</li><li><a href="function.imagecreatefromjpeg.html">imagecreatefromjpeg</a> &mdash; 新しい画像をファイルあるいは URL から作成する</li><li><a href="function.imagecreatefrompng.html">imagecreatefrompng</a> &mdash; 新しい画像をファイルあるいは URL から作成する</li><li><a href="function.imagecreatefromstring.html">imagecreatefromstring</a> &mdash; 文字列の中のイメージストリームから新規イメージを作成する</li><li><a href="function.imagecreatefromwbmp.html">imagecreatefromwbmp</a> &mdash; 新しい画像をファイルあるいは URL から作成する</li><li><a href="function.imagecreatefromwebp.html">imagecreatefromwebp</a> &mdash; 新しい画像をファイルあるいは URL から作成する</li><li><a href="function.imagecreatefromxbm.html">imagecreatefromxbm</a> &mdash; 新しい画像をファイルあるいは URL から作成する</li><li><a href="function.imagecreatefromxpm.html">imagecreatefromxpm</a> &mdash; 新しい画像をファイルあるいは URL から作成する</li><li><a href="function.imagecreatetruecolor.html">imagecreatetruecolor</a> &mdash; TrueColor イメージを新規に作成する</li><li><a href="function.imagecrop.html">imagecrop</a> &mdash; 指定した矩形に画像をクロップする</li><li><a href="function.imagecropauto.html">imagecropauto</a> &mdash; 利用可能なモードを指定して、画像を自動的にクロップする</li><li><a href="function.imagedashedline.html">imagedashedline</a> &mdash; 破線を描画する</li><li><a href="function.imagedestroy.html">imagedestroy</a> &mdash; 画像を破棄する</li><li><a href="function.imageellipse.html">imageellipse</a> &mdash; 楕円を描画する</li><li><a href="function.imagefill.html">imagefill</a> &mdash; 塗り潰す</li><li><a href="function.imagefilledarc.html">imagefilledarc</a> &mdash; 楕円弧を描画し、塗りつぶす</li><li><a href="function.imagefilledellipse.html">imagefilledellipse</a> &mdash; 塗りつぶされた楕円を描画する</li><li><a href="function.imagefilledpolygon.html">imagefilledpolygon</a> &mdash; 塗りつぶした多角形を描画する</li><li><a href="function.imagefilledrectangle.html">imagefilledrectangle</a> &mdash; 塗りつぶした矩形を描画する</li><li><a href="function.imagefilltoborder.html">imagefilltoborder</a> &mdash; 特定色で塗りつぶす</li><li><a href="function.imagefilter.html">imagefilter</a> &mdash; 画像にフィルタを適用する</li><li><a href="function.imageflip.html">imageflip</a> &mdash; 指定したモードで画像を反転させる</li><li><a href="function.imagefontheight.html">imagefontheight</a> &mdash; フォントの高さを取得する</li><li><a href="function.imagefontwidth.html">imagefontwidth</a> &mdash; フォントの幅を取得する</li><li><a href="function.imageftbbox.html">imageftbbox</a> &mdash; freetype2 によるフォントを用いたテキストを囲む箱を取得する</li><li><a href="function.imagefttext.html">imagefttext</a> &mdash; FreeType 2 によるフォントを用いてイメージにテキストを描画する</li><li><a href="function.imagegammacorrect.html">imagegammacorrect</a> &mdash; GD イメージにガンマ補正を適用する</li><li><a href="function.imagegd2.html">imagegd2</a> &mdash; GD2 イメージをブラウザまたはファイルに出力する</li><li><a href="function.imagegd.html">imagegd</a> &mdash; GD イメージをブラウザまたはファイルに出力する</li><li><a href="function.imagegetclip.html">imagegetclip</a> &mdash; Get the clipping rectangle</li><li><a href="function.imagegif.html">imagegif</a> &mdash; 画像をブラウザあるいはファイルに出力する</li><li><a href="function.imagegrabscreen.html">imagegrabscreen</a> &mdash; 画面全体をキャプチャする</li><li><a href="function.imagegrabwindow.html">imagegrabwindow</a> &mdash; ウィンドウをキャプチャする</li><li><a href="function.imageinterlace.html">imageinterlace</a> &mdash; インターレースを有効もしくは無効にする</li><li><a href="function.imageistruecolor.html">imageistruecolor</a> &mdash; 画像が truecolor かどうか調べる</li><li><a href="function.imagejpeg.html">imagejpeg</a> &mdash; 画像をブラウザあるいはファイルに出力する</li><li><a href="function.imagelayereffect.html">imagelayereffect</a> &mdash; アルファブレンディングフラグを設定し、レイヤ効果を使用する</li><li><a href="function.imageline.html">imageline</a> &mdash; 直線を描画する</li><li><a href="function.imageloadfont.html">imageloadfont</a> &mdash; 新しいフォントを読み込む</li><li><a href="function.imageopenpolygon.html">imageopenpolygon</a> &mdash; Draws an open polygon</li><li><a href="function.imagepalettecopy.html">imagepalettecopy</a> &mdash; あるイメージから他のイメージにパレットをコピーする</li><li><a href="function.imagepalettetotruecolor.html">imagepalettetotruecolor</a> &mdash; パレット形式の画像を true color に変換する</li><li><a href="function.imagepng.html">imagepng</a> &mdash; PNG イメージをブラウザまたはファイルに出力する</li><li><a href="function.imagepolygon.html">imagepolygon</a> &mdash; 多角形を描画する</li><li><a href="function.imagepsbbox.html">imagepsbbox</a> &mdash; PostScript Type1 フォントを用いてテキスト矩形のバウンディングボックスを指定する</li><li><a href="function.imagepsencodefont.html">imagepsencodefont</a> &mdash; フォントの文字エンコードベクトルを変更する</li><li><a href="function.imagepsextendfont.html">imagepsextendfont</a> &mdash; フォントを展開または圧縮する</li><li><a href="function.imagepsfreefont.html">imagepsfreefont</a> &mdash; PostScript Type 1 フォント用メモリを解放する</li><li><a href="function.imagepsloadfont.html">imagepsloadfont</a> &mdash; ファイルから PostScript Type 1 フォントをロードする</li><li><a href="function.imagepsslantfont.html">imagepsslantfont</a> &mdash; フォントを傾ける</li><li><a href="function.imagepstext.html">imagepstext</a> &mdash; PostScript Type1 フォントを用いて画像の上に文字列を描く</li><li><a href="function.imagerectangle.html">imagerectangle</a> &mdash; 矩形を描画する</li><li><a href="function.imageresolution.html">imageresolution</a> &mdash; Get or set the resolution of the image</li><li><a href="function.imagerotate.html">imagerotate</a> &mdash; 指定された角度で画像を回転する</li><li><a href="function.imagesavealpha.html">imagesavealpha</a> &mdash; PNG 画像を保存する際に（単一色の透過設定ではない）完全な
   アルファチャネル情報を保存するフラグを設定する</li><li><a href="function.imagescale.html">imagescale</a> &mdash; 幅と高さを指定して、画像の縮尺を変更する</li><li><a href="function.imagesetbrush.html">imagesetbrush</a> &mdash; 線の描画用にブラシイメージを設定する</li><li><a href="function.imagesetclip.html">imagesetclip</a> &mdash; Set the clipping rectangle</li><li><a href="function.imagesetinterpolation.html">imagesetinterpolation</a> &mdash; 補間方法を設定する</li><li><a href="function.imagesetpixel.html">imagesetpixel</a> &mdash; 点を生成する</li><li><a href="function.imagesetstyle.html">imagesetstyle</a> &mdash; 線描画用のスタイルを設定する</li><li><a href="function.imagesetthickness.html">imagesetthickness</a> &mdash; 線描画用の線幅を設定する</li><li><a href="function.imagesettile.html">imagesettile</a> &mdash; 塗りつぶし用のイメージを設定する</li><li><a href="function.imagestring.html">imagestring</a> &mdash; 文字列を水平に描画する</li><li><a href="function.imagestringup.html">imagestringup</a> &mdash; 文字列を垂直に描画する</li><li><a href="function.imagesx.html">imagesx</a> &mdash; 画像の幅を取得する</li><li><a href="function.imagesy.html">imagesy</a> &mdash; 画像の高さを取得する</li><li><a href="function.imagetruecolortopalette.html">imagetruecolortopalette</a> &mdash; TrueColor イメージをパレットイメージに変換する</li><li><a href="function.imagettfbbox.html">imagettfbbox</a> &mdash; TypeType フォントを使用したテキストの bounding box を生成する</li><li><a href="function.imagettftext.html">imagettftext</a> &mdash; TrueType フォントを使用してテキストを画像に書き込む</li><li><a href="function.imagetypes.html">imagetypes</a> &mdash; この PHP がサポートしている画像形式を返す</li><li><a href="function.imagewbmp.html">imagewbmp</a> &mdash; 画像をブラウザあるいはファイルに出力する</li><li><a href="function.imagewebp.html">imagewebp</a> &mdash; WebP 画像をブラウザあるいはファイルに出力する</li><li><a href="function.imagexbm.html">imagexbm</a> &mdash; XBM 画像をブラウザあるいはファイルに出力する</li><li><a href="function.iptcembed.html">iptcembed</a> &mdash; バイナリ IPTC データを JPEG イメージに埋めこむ</li><li><a href="function.iptcparse.html">iptcparse</a> &mdash; バイナリの IPTC ブロックのタグをパースする</li><li><a href="function.jpeg2wbmp.html">jpeg2wbmp</a> &mdash; Convert JPEG image file to WBMP image file</li><li><a href="function.png2wbmp.html">png2wbmp</a> &mdash; Convert PNG image file to WBMP image file</li></ul>
</div>
<div id="usernotes">
 <div class="head">
  <h3 class="title">User Contributed Notes</h3>
 </div>
<div id="allnotes">  <a name="120217""></a>
  <div class="note">
   <strong class="user">delabahan at gmail dot com</strong>
   <a href="#120217" class="date">24-Nov-2016 02:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is an example of get high resolution images.<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;</span><span class="comment">/**<br />
&nbsp;* Class name&nbsp; &nbsp; &nbsp; : resizeImage<br />
&nbsp;* Created by&nbsp;&nbsp; : wang<br />
&nbsp;* Description&nbsp;&nbsp; : This class is to resize the image from original size to new size <br />
&nbsp;*/<br />
</span><span class="keyword">class </span><span class="default">resizeImage<br />
</span><span class="keyword">{<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * Function name : resize_img<br />
&nbsp;&nbsp; &nbsp; * Description&nbsp;&nbsp; : This function is to resize image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $origimg variable is the original image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $newimg variable is the new image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $w variable is the width of image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $f variable is the height of image <br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">public&nbsp; function </span><span class="default">resize_img</span><span class="keyword">(</span><span class="default">$origimg</span><span class="keyword">,</span><span class="default">$newimg</span><span class="keyword">,</span><span class="default">$w</span><span class="keyword">,</span><span class="default">$h</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$info </span><span class="keyword">= </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$origimg</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$mime&nbsp;&nbsp; </span><span class="keyword">= </span><span class="default">$info</span><span class="keyword">[</span><span class="string">'mime'</span><span class="keyword">];<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Make sure that the requested file is actually an image<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">if(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$mime</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">6</span><span class="keyword">) != </span><span class="string">'image/'</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'HTTP/1.1 400 Bad Request'</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="string">'Error: requested file is not an accepted type: ' </span><span class="keyword">.</span><span class="default">$origimg</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; exit();<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">// Check they extention of image<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$extension </span><span class="keyword">= </span><span class="default">image_type_to_extension</span><span class="keyword">(</span><span class="default">$info</span><span class="keyword">[</span><span class="default">2</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$extension</span><span class="keyword">) == </span><span class="string">'.png'</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$img </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resize_imagepng</span><span class="keyword">(</span><span class="default">$origimg</span><span class="keyword">,</span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagepng</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">$newimg</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }elseif(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$extension</span><span class="keyword">) == </span><span class="string">'.jpeg'</span><span class="keyword">){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$img </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resize_imagejpeg</span><span class="keyword">(</span><span class="default">$origimg</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">, </span><span class="default">$newimg</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }elseif(</span><span class="default">strtolower</span><span class="keyword">(</span><span class="default">$extension </span><span class="keyword">== </span><span class="string">'.gif'</span><span class="keyword">)){<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$img </span><span class="keyword">= </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">resize_imagegif</span><span class="keyword">(</span><span class="default">$origimg</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagegif</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">,</span><span class="default">$newimg</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagedestroy</span><span class="keyword">(</span><span class="default">$img</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * End function name : resize_img<br />
&nbsp;&nbsp; &nbsp; */<br />
<br />
&nbsp;&nbsp; &nbsp; /**<br />
&nbsp;&nbsp; &nbsp; * Function name : resize_imagepng<br />
&nbsp;&nbsp; &nbsp; * Description&nbsp;&nbsp; : This function is to resize png image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $file variable is the original image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $w variable is the width of image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $f variable is the height of image <br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private function </span><span class="default">resize_imagepng</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$src </span><span class="keyword">= </span><span class="default">imagecreatefrompng</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$dst </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">imagecopyresampled</span><span class="keyword">(</span><span class="default">$dst</span><span class="keyword">, </span><span class="default">$src</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="default">$dst</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * End function name : resize_imagepng<br />
&nbsp;&nbsp; &nbsp; */<br />
<br />
&nbsp;&nbsp; &nbsp; /**<br />
&nbsp;&nbsp; &nbsp; * Function name : resize_imagejpeg<br />
&nbsp;&nbsp; &nbsp; * Description&nbsp;&nbsp; : This function is to resize jpeg image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $file variable is the original image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $w variable is the width of image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $f variable is the height of image <br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private function </span><span class="default">resize_imagejpeg</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$src </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$dst </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">imagecopyresampled</span><span class="keyword">(</span><span class="default">$dst</span><span class="keyword">, </span><span class="default">$src</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="default">$dst</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * End function name : resize_imagejpeg<br />
&nbsp;&nbsp; &nbsp; */<br />
<br />
&nbsp;&nbsp; &nbsp; /**<br />
&nbsp;&nbsp; &nbsp; * Function name : resize_imagegif<br />
&nbsp;&nbsp; &nbsp; * Description&nbsp;&nbsp; : This function is to resize gif image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $file variable is the original image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $w variable is the width of image <br />
&nbsp;&nbsp; &nbsp; * @param&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : $f variable is the height of image <br />
&nbsp;&nbsp; &nbsp; */<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">private function </span><span class="default">resize_imagegif</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; list(</span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">) = </span><span class="default">getimagesize</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$src </span><span class="keyword">= </span><span class="default">imagecreatefromgif</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$dst </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">imagecopyresampled</span><span class="keyword">(</span><span class="default">$dst</span><span class="keyword">, </span><span class="default">$src</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$w</span><span class="keyword">, </span><span class="default">$h</span><span class="keyword">, </span><span class="default">$width</span><span class="keyword">, </span><span class="default">$height</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; return </span><span class="default">$dst</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; </span><span class="comment">/**<br />
&nbsp;&nbsp; &nbsp; * End function name : resize_imagegif<br />
&nbsp;&nbsp; &nbsp; */<br />
</span><span class="keyword">}<br />
</span><span class="comment">/**<br />
* End class name : resizeImage<br />
*/<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="120139""></a>
  <div class="note">
   <strong class="user">mpyw</strong>
   <a href="#120139" class="date">10-Nov-2016 05:45</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
This is an example of black-and-white imagebmp() implementation. <br />
<br />
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
&nbsp;* Output a black-and-white BMP image to either the browser or a file.<br />
&nbsp;* <br />
&nbsp;* @param resource $image<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; An image resource, returned by one of the image creation functions,<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; such as imagecreatetruecolor().<br />
&nbsp;*<br />
&nbsp;* @param string|null $to<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The path or an open stream resource<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (which is automatically being closed after this function returns)<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to save the file to.<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If not set or NULL, the raw image stream will be outputted directly.<br />
&nbsp;*<br />
&nbsp;* @param float $threshold<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The number in the range of 0.0 to 1.0.<br />
&nbsp;*&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Brighter for larger, or darker for smaller.<br />
&nbsp;*<br />
&nbsp;* @return bool Returns TRUE on success or FALSE on failure.<br />
&nbsp;* <br />
&nbsp;*/<br />
</span><span class="keyword">function </span><span class="default">imagebwbmp</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$to </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">, </span><span class="default">$threshold </span><span class="keyword">= </span><span class="default">0.5</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">func_num_args</span><span class="keyword">() &lt; </span><span class="default">1</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fmt </span><span class="keyword">= </span><span class="string">"imagebwbmp() expects a least 1 parameters, %d given"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="default">$fmt</span><span class="keyword">, </span><span class="default">func_num_args</span><span class="keyword">()), </span><span class="default">E_USER_WARNING</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">is_resource</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fmt </span><span class="keyword">= </span><span class="string">"imagebwbmp() expects parameter 1 to be resource, %s given"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="default">$fmt</span><span class="keyword">, </span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">)), </span><span class="default">E_USER_WARNING</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">is_numeric</span><span class="keyword">(</span><span class="default">$threshold</span><span class="keyword">)) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fmt </span><span class="keyword">= </span><span class="string">"imagebwbmp() expects parameter 3 to be float, %s given"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="default">sprintf</span><span class="keyword">(</span><span class="default">$fmt</span><span class="keyword">, </span><span class="default">gettype</span><span class="keyword">(</span><span class="default">$threshold</span><span class="keyword">)), </span><span class="default">E_USER_WARNING</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">get_resource_type</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">) !== </span><span class="string">'gd'</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$msg </span><span class="keyword">= </span><span class="string">"imagebwbmp(): supplied resource is not a valid gd resource"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="default">$msg</span><span class="keyword">, </span><span class="default">E_USER_WARNING</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; switch (</span><span class="default">true</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">$to </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">is_resource</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">) &amp;&amp; </span><span class="default">get_resource_type</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">) === </span><span class="string">'stream'</span><span class="keyword">:<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case </span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">) &amp;&amp; </span><span class="default">$to </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="string">'wb'</span><span class="keyword">):<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'/[waxc+]/'</span><span class="keyword">, </span><span class="default">stream_get_meta_data</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">)[</span><span class="string">'mode'</span><span class="keyword">])) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; break;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; default:<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$msg </span><span class="keyword">= </span><span class="string">"imagebwbmp(): Invalid 2nd parameter, it must a writable filename or a writable stream"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">trigger_error</span><span class="keyword">(</span><span class="default">$msg</span><span class="keyword">, </span><span class="default">E_USER_WARNING</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$to </span><span class="keyword">=== </span><span class="default">null</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$to </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="string">'php://output'</span><span class="keyword">, </span><span class="string">'wb'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$biWidth </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$biHeight </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$biSizeImage </span><span class="keyword">= ((int)</span><span class="default">ceil</span><span class="keyword">(</span><span class="default">$biWidth </span><span class="keyword">/ </span><span class="default">32</span><span class="keyword">) * </span><span class="default">32 </span><span class="keyword">/ </span><span class="default">8 </span><span class="keyword">* </span><span class="default">$biHeight</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bfOffBits </span><span class="keyword">= </span><span class="default">54 </span><span class="keyword">+ </span><span class="default">4 </span><span class="keyword">* </span><span class="default">2</span><span class="keyword">; </span><span class="comment">// Use two colors (black and white)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bfSize </span><span class="keyword">= </span><span class="default">$bfOffBits </span><span class="keyword">+ </span><span class="default">$biSizeImage</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="string">'BM'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'VvvV'</span><span class="keyword">, </span><span class="default">$bfSize</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$bfOffBits</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'VVVvvVVVVVV'</span><span class="keyword">, </span><span class="default">40</span><span class="keyword">, </span><span class="default">$biWidth</span><span class="keyword">, </span><span class="default">$biHeight</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$biSizeImage</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="string">"\xff\xff\xff\x00"</span><span class="keyword">); </span><span class="comment">// white<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="string">"\x00\x00\x00\x00"</span><span class="keyword">); </span><span class="comment">// black<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">for (</span><span class="default">$y </span><span class="keyword">= </span><span class="default">$biHeight </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&gt;= </span><span class="default">0</span><span class="keyword">; --</span><span class="default">$y</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$byte </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">$biWidth</span><span class="keyword">; ++</span><span class="default">$x</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorsforindex</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$value </span><span class="keyword">= (</span><span class="default">0.299 </span><span class="keyword">* </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'red'</span><span class="keyword">] + </span><span class="default">0.587 </span><span class="keyword">* </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'green'</span><span class="keyword">] + </span><span class="default">0.114 </span><span class="keyword">* </span><span class="default">$rgb</span><span class="keyword">[</span><span class="string">'blue'</span><span class="keyword">]) / </span><span class="default">0xff</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$color </span><span class="keyword">= (int)(</span><span class="default">$value </span><span class="keyword">&gt; </span><span class="default">$threshold</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$byte </span><span class="keyword">= (</span><span class="default">$byte </span><span class="keyword">&lt;&lt; </span><span class="default">1</span><span class="keyword">) | </span><span class="default">$color</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$x </span><span class="keyword">% </span><span class="default">8 </span><span class="keyword">=== </span><span class="default">7</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'C'</span><span class="keyword">, </span><span class="default">$byte</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$byte </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$x </span><span class="keyword">% </span><span class="default">8</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="default">pack</span><span class="keyword">(</span><span class="string">'C'</span><span class="keyword">, </span><span class="default">$byte </span><span class="keyword">&lt;&lt; (</span><span class="default">8 </span><span class="keyword">- </span><span class="default">$x </span><span class="keyword">% </span><span class="default">8</span><span class="keyword">)));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if (</span><span class="default">$x </span><span class="keyword">% </span><span class="default">32</span><span class="keyword">) {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$to</span><span class="keyword">, </span><span class="default">str_repeat</span><span class="keyword">(</span><span class="string">"\x00"</span><span class="keyword">, (int)((</span><span class="default">32 </span><span class="keyword">- </span><span class="default">$x </span><span class="keyword">% </span><span class="default">32</span><span class="keyword">) / </span><span class="default">8</span><span class="keyword">)));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="106150""></a>
  <div class="note">
   <strong class="user">ingo at jache dot de</strong>
   <a href="#106150" class="date">14-Oct-2011 12:16</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I know this might look somewhat superfluous to others, but i once came across a situation where i needed a *strong* blur on an image without having ImageMagick installed. Executing the convolution-filter several times on the same image is awfully slow and still doesn't give a good blur.<br />
<br />
The function below accepts a truecolor-image and a blur-factor between 0.0 and 1.0. Beware: It's still quite slow.<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">blurImage</span><span class="keyword">(</span><span class="default">$srcimg</span><span class="keyword">,</span><span class="default">$blur</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$blur </span><span class="keyword">= </span><span class="default">$blur</span><span class="keyword">*</span><span class="default">$blur</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$blur </span><span class="keyword">= </span><span class="default">max</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">min</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">$blur</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$srcw </span><span class="keyword">= </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$srcimg</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$srch </span><span class="keyword">= </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$srcimg</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$dstimg </span><span class="keyword">= </span><span class="default">imagecreatetruecolor</span><span class="keyword">(</span><span class="default">$srcw</span><span class="keyword">,</span><span class="default">$srch</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$f1a </span><span class="keyword">= </span><span class="default">$blur</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$f1b </span><span class="keyword">= </span><span class="default">1.0 </span><span class="keyword">- </span><span class="default">$blur</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cr </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$cg </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$cb </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$ng </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$nb </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$srcimg</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$or </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">16</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$og </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">8</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ob </span><span class="keyword">= (</span><span class="default">$rgb</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//-------------------------------------------------<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // first line is a special case<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //-------------------------------------------------<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x </span><span class="keyword">= </span><span class="default">$srcw</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">= </span><span class="default">$srch</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$x</span><span class="keyword">--)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//horizontal blurren<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$srcimg</span><span class="keyword">,</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cr </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">16</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cg </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">8</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cb </span><span class="keyword">= (</span><span class="default">$rgb</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr </span><span class="keyword">= (</span><span class="default">$cr </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$or </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ng </span><span class="keyword">= (</span><span class="default">$cg </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$og </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nb </span><span class="keyword">= (</span><span class="default">$cb </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$ob </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);&nbsp; &nbsp; <br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$or </span><span class="keyword">= </span><span class="default">$nr</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$og </span><span class="keyword">= </span><span class="default">$ng</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ob </span><span class="keyword">= </span><span class="default">$nb</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$dstimg</span><span class="keyword">,</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">,(</span><span class="default">$nr </span><span class="keyword">&lt;&lt; </span><span class="default">16</span><span class="keyword">) | (</span><span class="default">$ng </span><span class="keyword">&lt;&lt; </span><span class="default">8</span><span class="keyword">) | (</span><span class="default">$nb</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//-------------------------------------------------<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //-------------------------------------------------<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; // now process the entire picture<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; //-------------------------------------------------<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$y </span><span class="keyword">= </span><span class="default">$srch</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$y</span><span class="keyword">--)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$srcimg</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$or </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">16</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$og </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">8</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ob </span><span class="keyword">= (</span><span class="default">$rgb</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$x </span><span class="keyword">= </span><span class="default">$srcw</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; while (</span><span class="default">$x</span><span class="keyword">--)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//horizontal <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$srcimg</span><span class="keyword">,</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cr </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">16</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cg </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">8</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$cb </span><span class="keyword">= (</span><span class="default">$rgb</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr </span><span class="keyword">= (</span><span class="default">$cr </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$or </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ng </span><span class="keyword">= (</span><span class="default">$cg </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$og </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nb </span><span class="keyword">= (</span><span class="default">$cb </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$ob </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$or </span><span class="keyword">= </span><span class="default">$nr</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$og </span><span class="keyword">= </span><span class="default">$ng</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ob </span><span class="keyword">= </span><span class="default">$nb</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//vertical <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$rgb </span><span class="keyword">= </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$dstimg</span><span class="keyword">,</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">+</span><span class="default">1</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vr </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">16</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vg </span><span class="keyword">= (</span><span class="default">$rgb </span><span class="keyword">&gt;&gt; </span><span class="default">8</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vb </span><span class="keyword">= (</span><span class="default">$rgb</span><span class="keyword">) &amp; </span><span class="default">0xFF</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nr </span><span class="keyword">= (</span><span class="default">$nr </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$vr </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$ng </span><span class="keyword">= (</span><span class="default">$ng </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$vg </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$nb </span><span class="keyword">= (</span><span class="default">$nb </span><span class="keyword">* </span><span class="default">$f1a</span><span class="keyword">) + (</span><span class="default">$vb </span><span class="keyword">* </span><span class="default">$f1b</span><span class="keyword">);&nbsp; &nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vr </span><span class="keyword">= </span><span class="default">$nr</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vg </span><span class="keyword">= </span><span class="default">$ng</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vb </span><span class="keyword">= </span><span class="default">$nb</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">imagesetpixel</span><span class="keyword">(</span><span class="default">$dstimg</span><span class="keyword">,</span><span class="default">$x</span><span class="keyword">,</span><span class="default">$y</span><span class="keyword">,(</span><span class="default">$nr </span><span class="keyword">&lt;&lt; </span><span class="default">16</span><span class="keyword">) | (</span><span class="default">$ng </span><span class="keyword">&lt;&lt; </span><span class="default">8</span><span class="keyword">) | (</span><span class="default">$nb</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="comment">//-------------------------------------------------<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">return </span><span class="default">$dstimg</span><span class="keyword">;&nbsp; &nbsp; &nbsp; &nbsp; <br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$srcimg </span><span class="keyword">= </span><span class="default">imagecreatefromjpeg</span><span class="keyword">(</span><span class="string">"test.jpg"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$dstimg </span><span class="keyword">= </span><span class="default">blurImage</span><span class="keyword">(</span><span class="default">$srcimg</span><span class="keyword">,</span><span class="default">0.2</span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">header</span><span class="keyword">(</span><span class="string">'Content-type: image/jpeg'</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; echo( </span><span class="default">imagejpeg</span><span class="keyword">(</span><span class="default">$dstimg</span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; exit();<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; <br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="87238""></a>
  <div class="note">
   <strong class="user">chuckstudios at gmail dot com</strong>
   <a href="#87238" class="date">26-Nov-2008 06:18</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote a simple function to convert an image resource to PGM (portable graymap) in order to feed it to an OCR program. It works just like the rest of the image output functions, and will convert to grayscale for you:<br />
<br />
<span class="default">&lt;?php<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">imagepgm</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$filename </span><span class="keyword">= </span><span class="default">null</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pgm </span><span class="keyword">= </span><span class="string">"P5 "</span><span class="keyword">.</span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">).</span><span class="string">" "</span><span class="keyword">.</span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">).</span><span class="string">" 255\n"</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$y </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&lt; </span><span class="default">imagesy</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">); </span><span class="default">$y</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for(</span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">imagesx</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">); </span><span class="default">$x</span><span class="keyword">++)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$colors </span><span class="keyword">= </span><span class="default">imagecolorsforindex</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">imagecolorat</span><span class="keyword">(</span><span class="default">$image</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$pgm </span><span class="keyword">.= </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0.3 </span><span class="keyword">* </span><span class="default">$colors</span><span class="keyword">[</span><span class="string">"red"</span><span class="keyword">] + </span><span class="default">0.59 </span><span class="keyword">* </span><span class="default">$colors</span><span class="keyword">[</span><span class="string">"green"</span><span class="keyword">] + </span><span class="default">0.11 </span><span class="keyword">* </span><span class="default">$colors</span><span class="keyword">[</span><span class="string">"blue"</span><span class="keyword">]);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$filename </span><span class="keyword">!= </span><span class="default">null</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$fp </span><span class="keyword">= </span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">, </span><span class="default">$pgm</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$fp</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">$pgm</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; }<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="79996""></a>
  <div class="note">
   <strong class="user">ph_corp at yahoo dot fr</strong>
   <a href="#79996" class="date">23-Dec-2007 12:19</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
<span class="default">&lt;?php<br />
<br />
</span><span class="comment">/**<br />
HSL/RGB conversion functions<br />
very useful for a lot of applications<br />
**/<br />
<br />
</span><span class="keyword">function </span><span class="default">RBGtoHSL </span><span class="keyword">( </span><span class="default">$R</span><span class="keyword">, </span><span class="default">$G</span><span class="keyword">, </span><span class="default">$B </span><span class="keyword">)<br />
{<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var_R </span><span class="keyword">= ( </span><span class="default">$R </span><span class="keyword">/ </span><span class="default">255 </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var_G </span><span class="keyword">= ( </span><span class="default">$G </span><span class="keyword">/ </span><span class="default">255 </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var_B </span><span class="keyword">= ( </span><span class="default">$B </span><span class="keyword">/ </span><span class="default">255 </span><span class="keyword">);<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var_Min </span><span class="keyword">= </span><span class="default">min</span><span class="keyword">( </span><span class="default">$var_R</span><span class="keyword">, </span><span class="default">$var_G</span><span class="keyword">, </span><span class="default">$var_B </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var_Max </span><span class="keyword">= </span><span class="default">max</span><span class="keyword">( </span><span class="default">$var_R</span><span class="keyword">, </span><span class="default">$var_G</span><span class="keyword">, </span><span class="default">$var_B </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$del_Max </span><span class="keyword">= </span><span class="default">$var_Max </span><span class="keyword">- </span><span class="default">$var_Min<br />
<br />
&nbsp;&nbsp;&nbsp; $L </span><span class="keyword">= ( </span><span class="default">$var_Max </span><span class="keyword">+ </span><span class="default">$var_Min </span><span class="keyword">) / </span><span class="default">2</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">$del_Max </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; </span><span class="default">$H </span><span class="keyword">= </span><span class="default">0<br />
&nbsp;&nbsp; &nbsp; &nbsp; $S </span><span class="keyword">= </span><span class="default">0<br />
&nbsp;&nbsp;&nbsp; </span><span class="keyword">}<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$L </span><span class="keyword">&lt; </span><span class="default">0.5 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$S </span><span class="keyword">= </span><span class="default">$del_Max </span><span class="keyword">/ ( </span><span class="default">$var_Max </span><span class="keyword">+ </span><span class="default">$var_Min </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$S </span><span class="keyword">= </span><span class="default">$del_Max </span><span class="keyword">/ ( </span><span class="default">2 </span><span class="keyword">- </span><span class="default">$var_Max </span><span class="keyword">- </span><span class="default">$var_Min </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$del_R </span><span class="keyword">= ( ( ( </span><span class="default">$var_Max </span><span class="keyword">- </span><span class="default">$var_R </span><span class="keyword">) / </span><span class="default">6 </span><span class="keyword">) + ( </span><span class="default">$del_Max </span><span class="keyword">/ </span><span class="default">2 </span><span class="keyword">) ) / </span><span class="default">$del_Max</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$del_G </span><span class="keyword">= ( ( ( </span><span class="default">$var_Max </span><span class="keyword">- </span><span class="default">$var_G </span><span class="keyword">) / </span><span class="default">6 </span><span class="keyword">) + ( </span><span class="default">$del_Max </span><span class="keyword">/ </span><span class="default">2 </span><span class="keyword">) ) / </span><span class="default">$del_Max</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$del_B </span><span class="keyword">= ( ( ( </span><span class="default">$var_Max </span><span class="keyword">- </span><span class="default">$var_B </span><span class="keyword">) / </span><span class="default">6 </span><span class="keyword">) + ( </span><span class="default">$del_Max </span><span class="keyword">/ </span><span class="default">2 </span><span class="keyword">) ) / </span><span class="default">$del_Max</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$var_R </span><span class="keyword">== </span><span class="default">$var_Max </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$H </span><span class="keyword">= </span><span class="default">$del_B </span><span class="keyword">- </span><span class="default">$del_G</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if ( </span><span class="default">$var_G </span><span class="keyword">== </span><span class="default">$var_Max </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$H </span><span class="keyword">= ( </span><span class="default">1 </span><span class="keyword">/ </span><span class="default">3 </span><span class="keyword">) + </span><span class="default">$del_R </span><span class="keyword">- </span><span class="default">$del_B</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else if ( </span><span class="default">$var_B </span><span class="keyword">== </span><span class="default">$var_Max </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$H </span><span class="keyword">= ( </span><span class="default">2 </span><span class="keyword">/ </span><span class="default">3 </span><span class="keyword">) + </span><span class="default">$del_G </span><span class="keyword">- </span><span class="default">$del_R</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$H </span><span class="keyword">&lt; </span><span class="default">0 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$H </span><span class="keyword">+= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$H </span><span class="keyword">&gt; </span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$H </span><span class="keyword">-= </span><span class="default">1<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">}<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return array( </span><span class="default">$H</span><span class="keyword">, </span><span class="default">$S</span><span class="keyword">, </span><span class="default">$L </span><span class="keyword">);<br />
<br />
}<br />
<br />
function </span><span class="default">HuetoRGB</span><span class="keyword">( </span><span class="default">$v1</span><span class="keyword">, </span><span class="default">$v2</span><span class="keyword">, </span><span class="default">$vH </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">$vH </span><span class="keyword">&lt; </span><span class="default">0 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vH </span><span class="keyword">+= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">$vH </span><span class="keyword">&gt; </span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$vH </span><span class="keyword">-= </span><span class="default">1</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if ( ( </span><span class="default">6 </span><span class="keyword">* </span><span class="default">$vH </span><span class="keyword">) &lt; </span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return ( </span><span class="default">$v1 </span><span class="keyword">+ ( </span><span class="default">$v2 </span><span class="keyword">- </span><span class="default">$v1 </span><span class="keyword">) * </span><span class="default">6 </span><span class="keyword">* </span><span class="default">$vH </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if ( ( </span><span class="default">2 </span><span class="keyword">* </span><span class="default">$vH </span><span class="keyword">) &lt; </span><span class="default">1 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return ( </span><span class="default">$v2 </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; if ( ( </span><span class="default">3 </span><span class="keyword">* </span><span class="default">$vH </span><span class="keyword">) &lt; </span><span class="default">2 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return ( </span><span class="default">$v1 </span><span class="keyword">+ ( </span><span class="default">$v2 </span><span class="keyword">- </span><span class="default">$v1 </span><span class="keyword">) * ( ( </span><span class="default">2 </span><span class="keyword">/ </span><span class="default">3 </span><span class="keyword">) - </span><span class="default">$vH </span><span class="keyword">) * </span><span class="default">6 </span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; return ( </span><span class="default">$v1 </span><span class="keyword">)<br />
}<br />
<br />
function </span><span class="default">HSLtoRGB </span><span class="keyword">( </span><span class="default">$H</span><span class="keyword">, </span><span class="default">$S</span><span class="keyword">, </span><span class="default">$L </span><span class="keyword">)<br />
{<br />
<br />
&nbsp;&nbsp;&nbsp; if ( </span><span class="default">$S </span><span class="keyword">== </span><span class="default">0 </span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$R </span><span class="keyword">= </span><span class="default">$L </span><span class="keyword">* </span><span class="default">255</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$G </span><span class="keyword">= </span><span class="default">$L </span><span class="keyword">* </span><span class="default">255</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$B </span><span class="keyword">= </span><span class="default">$L </span><span class="keyword">* </span><span class="default">255</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; else<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; if ( </span><span class="default">$L </span><span class="keyword">&lt; </span><span class="default">0.5 </span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$var_2 </span><span class="keyword">= </span><span class="default">$L </span><span class="keyword">* ( </span><span class="default">1 </span><span class="keyword">+ </span><span class="default">$S </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; else<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$var_2 </span><span class="keyword">= ( </span><span class="default">$L </span><span class="keyword">+ </span><span class="default">$S </span><span class="keyword">) - ( </span><span class="default">$S </span><span class="keyword">* </span><span class="default">$L </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$var_1 </span><span class="keyword">= </span><span class="default">2 </span><span class="keyword">* </span><span class="default">$L </span><span class="keyword">- </span><span class="default">$var_2</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$R </span><span class="keyword">= </span><span class="default">255 </span><span class="keyword">* </span><span class="default">HuetoRGB</span><span class="keyword">( </span><span class="default">$var_1</span><span class="keyword">, </span><span class="default">$var_2</span><span class="keyword">, </span><span class="default">$H </span><span class="keyword">+ ( </span><span class="default">1 </span><span class="keyword">/ </span><span class="default">3 </span><span class="keyword">) );<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$G </span><span class="keyword">= </span><span class="default">255 </span><span class="keyword">* </span><span class="default">HuetoRGB</span><span class="keyword">( </span><span class="default">$var_1</span><span class="keyword">, </span><span class="default">$var_2</span><span class="keyword">, </span><span class="default">$H </span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$B </span><span class="keyword">= </span><span class="default">255 </span><span class="keyword">* </span><span class="default">HuetoRGB</span><span class="keyword">( </span><span class="default">$var_1</span><span class="keyword">, </span><span class="default">$var_2</span><span class="keyword">, </span><span class="default">$H </span><span class="keyword">- ( </span><span class="default">1 </span><span class="keyword">/ </span><span class="default">3 </span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; }<br />
<br />
&nbsp;&nbsp;&nbsp; return array( </span><span class="default">$R</span><span class="keyword">, </span><span class="default">$G</span><span class="keyword">, </span><span class="default">$B </span><span class="keyword">);<br />
<br />
}<br />
<br />
function </span><span class="default">distance </span><span class="keyword">( </span><span class="default">$R1</span><span class="keyword">, </span><span class="default">$G1</span><span class="keyword">, </span><span class="default">$B1</span><span class="keyword">, </span><span class="default">$R2</span><span class="keyword">, </span><span class="default">$G2</span><span class="keyword">, </span><span class="default">$B2 </span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">sqrt </span><span class="keyword">( ( </span><span class="default">$R1 </span><span class="keyword">- </span><span class="default">$R2 </span><span class="keyword">)*( </span><span class="default">$R1 </span><span class="keyword">- </span><span class="default">$R2 </span><span class="keyword">) + ( </span><span class="default">$G1 </span><span class="keyword">- </span><span class="default">$G2 </span><span class="keyword">)*( </span><span class="default">$G1 </span><span class="keyword">- </span><span class="default">$G2 </span><span class="keyword">) + ( </span><span class="default">$B1 </span><span class="keyword">- </span><span class="default">$B2 </span><span class="keyword">)*( </span><span class="default">$B1 </span><span class="keyword">- </span><span class="default">$B2 </span><span class="keyword">) );<br />
&nbsp;&nbsp;&nbsp; return ( </span><span class="default">$result </span><span class="keyword">);<br />
}<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63689""></a>
  <div class="note">
   <strong class="user">shd at earthling dot net</strong>
   <a href="#63689" class="date">28-Mar-2006 01:44</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
If you happen to need a way to output a Windows BMP file (e.g. when using the PEAR ExcelWriter), feel free to use the following code:<br />
<br />
<span class="default">&lt;?php<br />
</span><span class="keyword">function </span><span class="default">imagebmp </span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$fn </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">)<br />
{<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$im</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; if (</span><span class="default">$fn </span><span class="keyword">=== </span><span class="default">false</span><span class="keyword">) </span><span class="default">$fn </span><span class="keyword">= </span><span class="string">'php://output'</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$f </span><span class="keyword">= </span><span class="default">fopen </span><span class="keyword">(</span><span class="default">$fn</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; if (!</span><span class="default">$f</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//Image dimensions<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$biWidth </span><span class="keyword">= </span><span class="default">imagesx </span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$biHeight </span><span class="keyword">= </span><span class="default">imagesy </span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$biBPLine </span><span class="keyword">= </span><span class="default">$biWidth </span><span class="keyword">* </span><span class="default">3</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$biStride </span><span class="keyword">= (</span><span class="default">$biBPLine </span><span class="keyword">+ </span><span class="default">3</span><span class="keyword">) &amp; ~</span><span class="default">3</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$biSizeImage </span><span class="keyword">= </span><span class="default">$biStride </span><span class="keyword">* </span><span class="default">$biHeight</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bfOffBits </span><span class="keyword">= </span><span class="default">54</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$bfSize </span><span class="keyword">= </span><span class="default">$bfOffBits </span><span class="keyword">+ </span><span class="default">$biSizeImage</span><span class="keyword">;<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//BITMAPFILEHEADER<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite </span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="string">'BM'</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite </span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="default">pack </span><span class="keyword">(</span><span class="string">'VvvV'</span><span class="keyword">, </span><span class="default">$bfSize</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$bfOffBits</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">//BITMAPINFO (BITMAPINFOHEADER)<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fwrite </span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="default">pack </span><span class="keyword">(</span><span class="string">'VVVvvVVVVVV'</span><span class="keyword">, </span><span class="default">40</span><span class="keyword">, </span><span class="default">$biWidth</span><span class="keyword">, </span><span class="default">$biHeight</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">, </span><span class="default">24</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">$biSizeImage</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">));<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$numpad </span><span class="keyword">= </span><span class="default">$biStride </span><span class="keyword">- </span><span class="default">$biBPLine</span><span class="keyword">;<br />
&nbsp;&nbsp;&nbsp; for (</span><span class="default">$y </span><span class="keyword">= </span><span class="default">$biHeight </span><span class="keyword">- </span><span class="default">1</span><span class="keyword">; </span><span class="default">$y </span><span class="keyword">&gt;= </span><span class="default">0</span><span class="keyword">; --</span><span class="default">$y</span><span class="keyword">)<br />
&nbsp;&nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$x </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$x </span><span class="keyword">&lt; </span><span class="default">$biWidth</span><span class="keyword">; ++</span><span class="default">$x</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; {<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$col </span><span class="keyword">= </span><span class="default">imagecolorat </span><span class="keyword">(</span><span class="default">$im</span><span class="keyword">, </span><span class="default">$x</span><span class="keyword">, </span><span class="default">$y</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite </span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="default">pack </span><span class="keyword">(</span><span class="string">'V'</span><span class="keyword">, </span><span class="default">$col</span><span class="keyword">), </span><span class="default">3</span><span class="keyword">);<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; }<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">$numpad</span><span class="keyword">; ++</span><span class="default">$i</span><span class="keyword">)<br />
&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">fwrite </span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">, </span><span class="default">pack </span><span class="keyword">(</span><span class="string">'C'</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">));<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">fclose </span><span class="keyword">(</span><span class="default">$f</span><span class="keyword">);<br />
&nbsp;&nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br />
}<br />
</span><span class="default">?&gt;<br />
</span><br />
It works the same way as regular imagejpeg/imagepng do and only supports GD2.0 true colour bitmaps (which is what's required by ExcelWriter).</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="63064""></a>
  <div class="note">
   <strong class="user">felipensp at gmail dot com</strong>
   <a href="#63064" class="date">13-Mar-2006 06:17</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
Representation decimal of a color in hexadecimal for use on functions of library GD.<br />
<br />
<span class="default">&lt;?php<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Representation hexadecimal<br />
&nbsp;&nbsp;&nbsp; </span><span class="default">$var </span><span class="keyword">= </span><span class="string">'#FFFFFF'</span><span class="keyword">;<br />
<br />
&nbsp;&nbsp;&nbsp; function </span><span class="default">getRgbFromGd</span><span class="keyword">(</span><span class="default">$color_hex</span><span class="keyword">) {<br />
<br />
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">array_map</span><span class="keyword">(</span><span class="string">'hexdec'</span><span class="keyword">, </span><span class="default">explode</span><span class="keyword">(</span><span class="string">'|'</span><span class="keyword">, </span><span class="default">wordwrap</span><span class="keyword">(</span><span class="default">substr</span><span class="keyword">(</span><span class="default">$color_hex</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">), </span><span class="default">2</span><span class="keyword">, </span><span class="string">'|'</span><span class="keyword">, </span><span class="default">1</span><span class="keyword">)));<br />
<br />
&nbsp;&nbsp;&nbsp; }<br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; </span><span class="default">print_r</span><span class="keyword">(</span><span class="default">getRgbFromGd</span><span class="keyword">(</span><span class="default">$var</span><span class="keyword">));<br />
<br />
&nbsp;&nbsp;&nbsp; </span><span class="comment">// Output: Array ( [0] =&gt; 255 [1] =&gt; 255 [2] =&gt; 255 )<br />
<br />
</span><span class="default">?&gt;</span>
</span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="57909""></a>
  <div class="note">
   <strong class="user">michal-ok at o2 dot pl</strong>
   <a href="#57909" class="date">18-Oct-2005 11:29</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
The image sharpen function (by Alex R. Austin) provided below seems to be very resource hungry and I couldn't make it work on two different servers - trying to sharpen a 413 x 413 image I ended up with "Fatal error: Allowed memory size of 8388608 bytes exhausted" or "Internal Server Error" or the script terminated without notice. Because I had no priviliges to change the default memory limit on these servers I started looking for other sharpen functions. I have come across a php Unsharp Mask function which works like a charm on both of the servers I dealt with. It can be found at <a href="http://vikjavev.no/hovudsida/umtestside.php." rel="nofollow" target="_blank">http://vikjavev.no/hovudsida/umtestside.php.</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
  <a name="37131""></a>
  <div class="note">
   <strong class="user">jeff at lushmedia dot com</strong>
   <a href="#37131" class="date">04-Nov-2003 05:52</a>
   <div class="text">
    <div class="phpcode">
<code><span class="html">
I wrote an online overview of the image functions that people might find useful. In addition to a general overview of the various function categories and code samples, I have included many interactive examples of the functions, allowing viewers to experiment with the parameters, and seeing the results in real time. The presentation is located at New York PHP<br />
<a href="http://www.nyphp.org/content/presentations/GDintro/" rel="nofollow" target="_blank">http://www.nyphp.org/content/presentations/GDintro/</a></span>
</code>
    </div>
   </div>
  </div>
 <div class="foot"></div>
</div>
</div>
<hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="image.examples.merged-watermark.html">imagecopymerge による半透明なすかしの作成</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.gd-info.html">gd_info</a></div>
 <div class="up"><a href="book.image.html">GD</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
